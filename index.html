<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCTV Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8fafc;
            min-height: 100vh;
        }

        /* Login Page Styles */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 12px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .login-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #7c3aed, #3b82f6);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 32px;
        }

        .login-title {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .login-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .demo-accounts {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
        }

        .demo-title {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
            text-align: center;
        }

        .demo-account {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .demo-account:hover {
            background: #e2e8f0;
            border-color: #2563eb;
        }

        .demo-account-info {
            font-size: 14px;
        }

        .demo-account-role {
            font-weight: 600;
            color: #1e293b;
        }

        .demo-account-email {
            color: #64748b;
            font-size: 12px;
        }

        .demo-account-badge {
            font-size: 10px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .admin-badge {
            background: #fee2e2;
            color: #991b1b;
        }

        .contractor-badge {
            background: #dbeafe;
            color: #1e40af;
        }

        /* Main App Styles */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        .top-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 50;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .menu-toggle {
            background: none;
            border: none;
            padding: 8px;
            margin-right: 12px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 18px;
        }

        .menu-toggle:hover {
            background: #f1f5f9;
        }

        .logo {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #7c3aed, #3b82f6);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 16px;
        }

        .header-title h1 {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
        }

        .header-right {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #e2e8f0;
        }

        .user-info:hover {
            background: #f1f5f9;
        }

        .user-avatar {
            width: 28px;
            height: 28px;
            background: #94a3b8;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .user-details {
            font-size: 14px;
            font-weight: 500;
            color: #1e293b;
        }

        .user-role-badge {
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 8px;
        }

        .logout-btn {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            padding: 6px;
            border-radius: 4px;
        }

        .logout-btn:hover {
            background: #fee2e2;
            color: #dc2626;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e2e8f0;
            margin-top: 56px;
            position: fixed;
            height: calc(100vh - 56px);
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 40;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-content {
            padding: 16px 0;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0 16px 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 12px 16px;
            border: none;
            background: none;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: #475569;
        }

        .nav-item:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .nav-item.active {
            background: #eff6ff;
            color: #2563eb;
            border-right: 3px solid #2563eb;
        }

        .nav-icon {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            font-size: 16px;
            text-align: center;
        }

        .nav-badge {
            margin-left: auto;
            background: #e2e8f0;
            color: #64748b;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .nav-badge.urgent {
            background: #fee2e2;
            color: #dc2626;
        }

        .nav-badge.success {
            background: #dcfce7;
            color: #166534;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            margin-top: 56px;
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .content-header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 20px 24px;
        }

        .content-title {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .content-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .content-body {
            padding: 24px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -8px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .stat-blue .stat-number { color: #2563eb; }
        .stat-green .stat-number { color: #059669; }
        .stat-red .stat-number { color: #dc2626; }
        .stat-orange .stat-number { color: #ea580c; }

        /* Camera Cards */
        .cameras-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 20px;
        }

        .camera-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s;
        }

        .camera-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -8px rgba(0, 0, 0, 0.1);
        }

        .camera-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .camera-info {
            flex: 1;
        }

        .camera-title {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .camera-title h3 {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-left: 8px;
        }

        .camera-location {
            display: flex;
            align-items: center;
            font-size: 13px;
            color: #64748b;
            margin-bottom: 12px;
        }

        .camera-badges {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-checked {
            background: #dcfce7;
            color: #166534;
        }

        .badge-overdue {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-due-soon {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-priority {
            border: 1px solid;
        }

        .badge-high {
            background: #fee2e2;
            color: #b91c1c;
            border-color: #fecaca;
        }

        .badge-medium {
            background: #fed7aa;
            color: #c2410c;
            border-color: #fdba74;
        }

        .badge-low {
            background: #f3f4f6;
            color: #374151;
            border-color: #d1d5db;
        }

        .camera-details {
            font-size: 13px;
            margin-bottom: 16px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .detail-label {
            color: #64748b;
        }

        .detail-value {
            color: #1e293b;
            font-weight: 500;
        }

        .detail-value.overdue {
            color: #dc2626;
        }

        .previous-notes {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            color: #64748b;
            margin-top: 8px;
            border-left: 3px solid #e2e8f0;
        }

        .check-button {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .check-button.enabled {
            background: #2563eb;
            color: white;
        }

        .check-button.enabled:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }

        .check-button.disabled {
            background: #f1f5f9;
            color: #94a3b8;
            cursor: not-allowed;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            z-index: 100;
        }

        .modal.hidden {
            display: none;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 500px;
            padding: 24px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .modal-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .form-section {
            margin-bottom: 24px;
        }

        .form-section h4 {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 12px;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            transition: background-color 0.2s;
            border: 1px solid #e2e8f0;
        }

        .checkbox-item:hover {
            background: #f8fafc;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            accent-color: #2563eb;
        }

        .checkbox-item label {
            font-size: 14px;
            color: #1e293b;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }

        .form-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            font-family: inherit;
        }

        .form-textarea:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .modal-button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-button.primary {
            background: #059669;
            color: white;
        }

        .modal-button.primary:hover:not(:disabled) {
            background: #047857;
        }

        .modal-button.primary:disabled {
            background: #d1d5db;
            cursor: not-allowed;
        }

        .modal-button.secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }

        .modal-button.secondary:hover {
            background: #e2e8f0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .content-header {
                padding: 16px;
            }

            .content-body {
                padding: 16px;
            }

            .cameras-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal-content {
                margin: 8px;
                padding: 20px;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="login-logo">
                        üì∑
                    </div>
                    <h1 class="login-title">CCTV Management</h1>
                    <p class="login-subtitle">Sign in to your account</p>
                </div>

                <div class="demo-accounts">
                    <div class="demo-title">Demo Accounts - Click to Login</div>
                    <div class="demo-account" onclick="loginAs('admin')">
                        <div class="demo-account-info">
                            <div class="demo-account-role">Site Manager</div>
                            <div class="demo-account-email">admin@site.com</div>
                        </div>
                        <span class="demo-account-badge admin-badge">ADMIN</span>
                    </div>
                    <div class="demo-account" onclick="loginAs('contractor')">
                        <div class="demo-account-info">
                            <div class="demo-account-role">Field Contractor</div>
                            <div class="demo-account-email">john@securetech.com</div>
                        </div>
                        <span class="demo-account-badge contractor-badge">CONTRACTOR</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="main-app" class="hidden">
        <!-- Top Header -->
        <div class="top-header">
            <div class="header-left">
                <button class="menu-toggle" onclick="toggleSidebar()">
                    ‚ò∞
                </button>
                <div class="logo">
                    üì∑
                </div>
                <div class="header-title">
                    <h1 id="app-title">CCTV Management</h1>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-details" id="current-user-name">John Smith</div>
                    <span class="user-role-badge contractor-badge" id="current-user-role">CONTRACTOR</span>
                    <div class="user-avatar" id="current-user-avatar">JS</div>
                    <button class="logout-btn" onclick="logout()" title="Sign Out">üö™</button>
                </div>
            </div>
        </div>

        <div class="app-container">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-content">
                    <!-- Contractor Navigation -->
                    <div id="contractor-nav">
                        <div class="nav-section">
                            <div class="nav-section-title">Camera Management</div>
                            <button class="nav-item active" onclick="navigateTo('dashboard')">
                                <span class="nav-icon">üìä</span>
                                Dashboard
                            </button>
                            <button class="nav-item" onclick="navigateTo('my-cameras')">
                                <span class="nav-icon">üì∑</span>
                                My Cameras
                                <span class="nav-badge" id="nav-assigned-count">5</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('overdue')">
                                <span class="nav-icon">‚ö†Ô∏è</span>
                                Overdue Checks
                                <span class="nav-badge urgent" id="nav-overdue-count">3</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('completed')">
                                <span class="nav-icon">‚úÖ</span>
                                Today's Checks
                                <span class="nav-badge success" id="nav-completed-count">0</span>
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Reports</div>
                            <button class="nav-item" onclick="navigateTo('history')">
                                <span class="nav-icon">üìú</span>
                                Check History
                            </button>
                        </div>
                    </div>

                    <!-- Admin Navigation -->
                    <div id="admin-nav" class="hidden">
                        <div class="nav-section">
                            <div class="nav-section-title">Dashboard</div>
                            <button class="nav-item active" onclick="navigateTo('admin-dashboard')">
                                <span class="nav-icon">üìä</span>
                                Overview
                            </button>
                            <button class="nav-item" onclick="navigateTo('analytics')">
                                <span class="nav-icon">üìà</span>
                                Analytics
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Asset Management</div>
                            <button class="nav-item" onclick="navigateTo('all-cameras')">
                                <span class="nav-icon">üì∑</span>
                                All Cameras
                                <span class="nav-badge" id="nav-total-cameras">5</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('locations')">
                                <span class="nav-icon">üìç</span>
                                Locations
                            </button>
                            <button class="nav-item" onclick="navigateTo('freshservice-sync')">
                                <span class="nav-icon">üîÑ</span>
                                Freshservice Sync
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">User Management</div>
                            <button class="nav-item" onclick="navigateTo('users')">
                                <span class="nav-icon">üë•</span>
                                All Users
                                <span class="nav-badge" id="nav-total-users">3</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('permissions')">
                                <span class="nav-icon">üõ°Ô∏è</span>
                                Permissions
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">System</div>
                            <button class="nav-item" onclick="navigateTo('settings')">
                                <span class="nav-icon">‚öôÔ∏è</span>
                                Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content" id="main-content">
                
                <!-- Contractor Dashboard -->
                <div id="dashboard-page">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Dashboard</h1>
                            <p class="content-subtitle">Overview of your camera assignments</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="stat-assigned">5</div>
                                <div class="stat-label">Assigned Cameras</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="stat-checked">0</div>
                                <div class="stat-label">Checked Today</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="stat-overdue">3</div>
                                <div class="stat-label">Overdue Checks</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="stat-issues">2</div>
                                <div class="stat-label">Open Issues</div>
                            </div>
                        </div>
                        
                        <div class="cameras-grid" id="cameras-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Admin Dashboard -->
                <div id="admin-dashboard-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Admin Dashboard</h1>
                            <p class="content-subtitle">System overview and management</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="admin-stat-cameras">5</div>
                                <div class="stat-label">Total Cameras</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="admin-stat-active">3</div>
                                <div class="stat-label">Active Users</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="admin-stat-pending">3</div>
                                <div class="stat-label">Pending Checks</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="admin-stat-issues">2</div>
                                <div class="stat-label">Open Issues</div>
                            </div>
                        </div>
                        
                        <div class="cameras-grid" id="admin-cameras-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Other Pages -->
                <div id="my-cameras-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">My Cameras</h1>
                            <p class="content-subtitle">Cameras assigned to you</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div id="my-cameras-grid" class="cameras-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div id="overdue-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Overdue Checks</h1>
                            <p class="content-subtitle">Cameras that need immediate attention</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div id="overdue-grid" class="cameras-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div id="completed-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Today's Checks</h1>
                            <p class="content-subtitle">Cameras checked today</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div id="completed-grid" class="cameras-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <div id="all-cameras-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">All Cameras</h1>
                            <p class="content-subtitle">Manage all camera assets</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div id="all-cameras-grid" class="cameras-grid">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Check Modal -->
    <div class="modal hidden" id="check-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="check-modal-title">Camera Check</h3>
                <p class="modal-subtitle" id="check-modal-subtitle"></p>
            </div>

            <div class="form-section">
                <h4>Camera Status Check</h4>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="check-working" checked>
                        <label for="check-working">Camera is working and recording</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="check-lens" checked>
                        <label for="check-lens">Lens is clean and clear</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="check-position" checked>
                        <label for="check-position">Camera position is correct</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="check-lighting" checked>
                        <label for="check-lighting">Lighting is adequate</label>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="checkbox-item" style="border: 2px solid #fee2e2; background: #fef2f2;">
                    <input type="checkbox" id="issues-found">
                    <label for="issues-found" style="color: #dc2626; font-weight: 600;">Issues found</label>
                </div>
                <div class="form-group">
                    <textarea
                        id="issue-description"
                        class="form-textarea hidden"
                        rows="3"
                        placeholder="Describe the issues found..."
                        style="border-color: #fca5a5; background: #fef2f2;"></textarea>
                </div>
            </div>

            <div class="form-group">
                <label for="additional-notes" class="form-label">Additional Notes (Optional)</label>
                <textarea
                    id="additional-notes"
                    class="form-textarea"
                    rows="3"
                    placeholder="Any additional observations..."></textarea>
            </div>

            <div class="modal-actions">
                <button class="modal-button primary" id="complete-check" onclick="completeCheck()">
                    Complete Check
                </button>
                <button class="modal-button secondary" onclick="closeModal()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentUser = null;
        let currentPage = 'dashboard';
        let selectedCamera = null;
        let sidebarOpen = true;

        // Sample data
        let cameras = [
            {
                id: 'CAM001',
                name: 'Front Entrance Camera',
                location: 'Main Entrance - Building A',
                asset_tag: 'FS-CAM-001',
                serial_number: 'SN123456',
                lastChecked: '2025-05-28',
                inspectionNotes: 'Previous check: lens cleaned, all functions normal',
                assignedTo: 'John Smith',
                priority: 'high',
                status: 'overdue',
                freshservice_id: '12345'
            },
            {
                id: 'CAM002',
                name: 'Parking Lot Camera A',
                location: 'North Parking Area',
                asset_tag: 'FS-CAM-002',
                serial_number: 'SN123457',
                lastChecked: '2025-05-15',
                inspectionNotes: 'Previous check: slight dirt on lens',
                assignedTo: 'John Smith',
                priority: 'medium',
                status: 'overdue',
                freshservice_id: '12346'
            },
            {
                id: 'CAM003',
                name: 'Loading Bay Camera',
                location: 'Service Entrance - Dock 3',
                asset_tag: 'FS-CAM-003',
                serial_number: 'SN123458',
                lastChecked: '2025-06-02',
                inspectionNotes: 'Previous check: clear view, good condition',
                assignedTo: 'John Smith',
                priority: 'low',
                status: 'recent',
                freshservice_id: '12347'
            },
            {
                id: 'CAM004',
                name: 'Emergency Exit Camera',
                location: 'East Wing - Fire Exit 2',
                asset_tag: 'FS-CAM-004',
                serial_number: 'SN123459',
                lastChecked: '2025-05-20',
                inspectionNotes: '',
                assignedTo: 'Mike Johnson',
                priority: 'high',
                status: 'overdue',
                freshservice_id: '12348'
            },
            {
                id: 'CAM005',
                name: 'Reception Area Camera',
                location: 'Main Lobby - Visitor Desk',
                asset_tag: 'FS-CAM-005',
                serial_number: 'SN123460',
                lastChecked: '2025-06-01',
                inspectionNotes: 'Previous check: functioning normally',
                assignedTo: 'Sarah Wilson',
                priority: 'medium',
                status: 'due-soon',
                freshservice_id: '12349'
            }
        ];

        // Authentication functions
        function loginAs(role) {
            if (role === 'admin') {
                currentUser = {
                    id: 'USER002',
                    name: 'Sarah Wilson',
                    email: 'admin@site.com',
                    role: 'admin',
                    company: 'Site Management'
                };
            } else {
                currentUser = {
                    id: 'USER001',
                    name: 'John Smith',
                    email: 'john@securetech.com',
                    role: 'contractor',
                    company: 'SecureTech Ltd'
                };
            }
            
            showMainApp();
        }

        function showMainApp() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            
            updateUserInterface();
            updateNavigation();
            updateStats();
            renderCameras();
            
            if (currentUser.role === 'admin') {
                navigateTo('admin-dashboard');
            } else {
                navigateTo('dashboard');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
        }

        function updateUserInterface() {
            document.getElementById('current-user-name').textContent = currentUser.name;
            document.getElementById('current-user-role').textContent = currentUser.role.toUpperCase();
            document.getElementById('current-user-avatar').textContent = currentUser.name.split(' ').map(n => n[0]).join('');
            
            const roleClass = currentUser.role === 'admin' ? 'admin-badge' : 'contractor-badge';
            document.getElementById('current-user-role').className = `user-role-badge ${roleClass}`;
        }

        function updateNavigation() {
            if (currentUser.role === 'admin') {
                document.getElementById('contractor-nav').classList.add('hidden');
                document.getElementById('admin-nav').classList.remove('hidden');
                document.getElementById('app-title').textContent = 'CCTV Admin Portal';
            } else {
                document.getElementById('admin-nav').classList.add('hidden');
                document.getElementById('contractor-nav').classList.remove('hidden');
                document.getElementById('app-title').textContent = 'CCTV Contractor Portal';
            }
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            
            if (currentUser.role === 'contractor') {
                const assigned = cameras.filter(c => c.assignedTo === currentUser.name).length;
                const checkedToday = cameras.filter(c => c.lastChecked === today && c.assignedTo === currentUser.name).length;
                const overdue = cameras.filter(c => c.status === 'overdue' && c.assignedTo === currentUser.name).length;
                
                document.getElementById('stat-assigned').textContent = assigned;
                document.getElementById('stat-checked').textContent = checkedToday;
                document.getElementById('stat-overdue').textContent = overdue;
                document.getElementById('stat-issues').textContent = 2;
                
                document.getElementById('nav-assigned-count').textContent = assigned;
                document.getElementById('nav-overdue-count').textContent = overdue;
                document.getElementById('nav-completed-count').textContent = checkedToday;
            } else {
                const totalCameras = cameras.length;
                const checkedToday = cameras.filter(c => c.lastChecked === today).length;
                const overdue = cameras.filter(c => c.status === 'overdue').length;
                
                document.getElementById('admin-stat-cameras').textContent = totalCameras;
                document.getElementById('admin-stat-active').textContent = 3;
                document.getElementById('admin-stat-pending').textContent = overdue;
                document.getElementById('admin-stat-issues').textContent = 2;
                
                document.getElementById('nav-total-cameras').textContent = totalCameras;
                document.getElementById('nav-total-users').textContent = 3;
            }
        }

        // Navigation
        function navigateTo(page) {
            // Hide all pages
            document.querySelectorAll('[id$="-page"]').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            document.getElementById(page + '-page').classList.remove('hidden');
            
            // Update nav active state
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.target.classList.add('active');
            
            currentPage = page;
            renderCameras();
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }
        }

        // Camera management
        function performCheck(cameraId) {
            selectedCamera = cameras.find(c => c.id === cameraId);
            if (!selectedCamera) return;
            
            document.getElementById('check-modal-title').textContent = `Check: ${selectedCamera.name}`;
            document.getElementById('check-modal-subtitle').textContent = selectedCamera.location;
            
            // Reset form
            document.getElementById('check-working').checked = true;
            document.getElementById('check-lens').checked = true;
            document.getElementById('check-position').checked = true;
            document.getElementById('check-lighting').checked = true;
            document.getElementById('issues-found').checked = false;
            document.getElementById('issue-description').value = '';
            document.getElementById('additional-notes').value = '';
            document.getElementById('issue-description').classList.add('hidden');
            
            document.getElementById('check-modal').classList.remove('hidden');
        }

        function completeCheck() {
            if (!selectedCamera) return;
            
            const working = document.getElementById('check-working').checked;
            const lens = document.getElementById('check-lens').checked;
            const position = document.getElementById('check-position').checked;
            const lighting = document.getElementById('check-lighting').checked;
            const issuesFound = document.getElementById('issues-found').checked;
            const issueDescription = document.getElementById('issue-description').value;
            const additionalNotes = document.getElementById('additional-notes').value;
            
            if (!working || !lens || !position || !lighting) {
                alert('All status checks must be completed.');
                return;
            }
            
            if (issuesFound && !issueDescription.trim()) {
                alert('Please describe the issues found.');
                return;
            }
            
            // Update camera
            const today = new Date().toISOString().split('T')[0];
            let notes = additionalNotes.trim();
            if (issuesFound && issueDescription.trim()) {
                notes += (notes ? ' - ' : '') + `ISSUES: ${issueDescription.trim()}`;
            }
            
            selectedCamera.lastChecked = today;
            selectedCamera.inspectionNotes = notes || 'Check completed - no issues reported';
            selectedCamera.status = 'checked';
            selectedCamera.lastCheckedBy = currentUser.name;
            
            closeModal();
            updateStats();
            renderCameras();
            
            alert(`Check completed successfully for ${selectedCamera.name}`);
        }

        function closeModal() {
            document.getElementById('check-modal').classList.add('hidden');
            selectedCamera = null;
        }

        // Rendering functions
        function renderCameras() {
            const today = new Date().toISOString().split('T')[0];
            let filteredCameras = cameras;
            let containerId = 'cameras-grid';
            
            // Filter cameras based on current page and user role
            switch(currentPage) {
                case 'dashboard':
                    if (currentUser.role === 'contractor') {
                        filteredCameras = cameras.filter(c => c.assignedTo === currentUser.name);
                        containerId = 'cameras-grid';
                    } else {
                        filteredCameras = cameras;
                        containerId = 'admin-cameras-grid';
                    }
                    break;
                case 'admin-dashboard':
                    filteredCameras = cameras;
                    containerId = 'admin-cameras-grid';
                    break;
                case 'my-cameras':
                    filteredCameras = cameras.filter(c => c.assignedTo === currentUser.name);
                    containerId = 'my-cameras-grid';
                    break;
                case 'overdue':
                    filteredCameras = cameras.filter(c => {
                        const isOverdue = c.status === 'overdue';
                        return currentUser.role === 'admin' ? isOverdue : (isOverdue && c.assignedTo === currentUser.name);
                    });
                    containerId = 'overdue-grid';
                    break;
                case 'completed':
                    filteredCameras = cameras.filter(c => {
                        const isCheckedToday = c.lastChecked === today;
                        return currentUser.role === 'admin' ? isCheckedToday : (isCheckedToday && c.assignedTo === currentUser.name);
                    });
                    containerId = 'completed-grid';
                    break;
                case 'all-cameras':
                    filteredCameras = cameras;
                    containerId = 'all-cameras-grid';
                    break;
            }
            
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.innerHTML = filteredCameras.map(camera => createCameraCard(camera)).join('');
        }

        function createCameraCard(camera) {
            const today = new Date().toISOString().split('T')[0];
            const isCheckedToday = camera.lastChecked === today;
            const canCheck = currentUser.role === 'contractor' && camera.assignedTo === currentUser.name && !isCheckedToday;
            
            return `
                <div class="camera-card">
                    <div class="camera-header">
                        <div class="camera-info">
                            <div class="camera-title">
                                <span style="font-size: 18px;">üì∑</span>
                                <h3>${camera.name}</h3>
                            </div>
                            <div class="camera-location">
                                <span style="font-size: 12px; margin-right: 4px;">üìç</span>
                                <span>${camera.location}</span>
                            </div>
                            <div class="camera-badges">
                                ${getStatusBadge(camera)}
                                ${getPriorityBadge(camera.priority)}
                            </div>
                        </div>
                        <div class="camera-status">
                            ${getStatusIcon(camera)}
                        </div>
                    </div>
                    
                    <div class="camera-details">
                        <div class="detail-row">
                            <span class="detail-label">Last Checked:</span>
                            <span class="detail-value ${camera.status === 'overdue' ? 'overdue' : ''}">
                                ${camera.lastChecked ? formatDate(camera.lastChecked) : 'Never'}
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Assigned To:</span>
                            <span class="detail-value">${camera.assignedTo || 'Unassigned'}</span>
                        </div>
                        ${camera.inspectionNotes ? `
                            <div>
                                <span class="detail-label">Previous Notes:</span>
                                <div class="previous-notes">${camera.inspectionNotes}</div>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${canCheck ? `
                        <button class="check-button enabled" onclick="performCheck('${camera.id}')">
                            Perform Check
                        </button>
                    ` : `
                        <button class="check-button disabled" disabled>
                            ${isCheckedToday ? 'Already Checked Today' : 'Not Assigned to You'}
                        </button>
                    `}
                </div>
            `;
        }

        // Helper functions
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-GB');
        }

        function getStatusBadge(camera) {
            const today = new Date().toISOString().split('T')[0];
            if (camera.lastChecked === today) {
                return '<span class="badge badge-checked">Checked Today</span>';
            } else if (camera.status === 'overdue') {
                return '<span class="badge badge-overdue">Overdue</span>';
            } else {
                return '<span class="badge badge-due-soon">Due Soon</span>';
            }
        }

        function getPriorityBadge(priority) {
            const classes = {
                'high': 'badge-high',
                'medium': 'badge-medium',
                'low': 'badge-low'
            };
            return `<span class="badge badge-priority ${classes[priority]}">${priority.toUpperCase()}</span>`;
        }

        function getStatusIcon(camera) {
            const today = new Date().toISOString().split('T')[0];
            if (camera.lastChecked === today) {
                return '<span style="color: #059669; font-size: 20px;">‚úÖ</span>';
            } else if (camera.status === 'overdue') {
                return '<span style="color: #dc2626; font-size: 20px;">‚ö†Ô∏è</span>';
            } else {
                return '<span style="color: #f59e0b; font-size: 20px;">üïê</span>';
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Issues checkbox handler
            document.getElementById('issues-found').addEventListener('change', function() {
                const issueDescription = document.getElementById('issue-description');
                if (this.checked) {
                    issueDescription.classList.remove('hidden');
                    issueDescription.required = true;
                } else {
                    issueDescription.classList.add('hidden');
                    issueDescription.required = false;
                    issueDescription.value = '';
                }
            });

            // Close modal when clicking outside
            document.getElementById('check-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            // Responsive sidebar
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    document.getElementById('sidebar').classList.remove('open');
                }
            });
        });

        // Make functions globally available
        window.loginAs = loginAs;
        window.logout = logout;
        window.navigateTo = navigateTo;
        window.toggleSidebar = toggleSidebar;
        window.performCheck = performCheck;
        window.completeCheck = completeCheck;
        window.closeModal = closeModal;
    </script>
</body>
</html>
