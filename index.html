<button onclick="closeModal('check-modal')" style="flex: 1; padding: 12px 20px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; background: #f1f5f9; color: #475569;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Camera Modal -->
    <div class="modal hidden" id="camera-modal" style="position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; padding: 16px; z-index: 100;">
        <div style="background: white; border-radius: 16px; width: 100%; max-width: 600px; padding: 24px; max-height: 90vh; overflow-y: auto;">
            <div style="margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid #e2e8f0;">
                <h3 id="camera-modal-title" style="font-size: 20px; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Edit Camera</h3>
                <p style="font-size: 14px; color: #64748b;">Camera asset information</p>
            </div>

            <form id="camera-form">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="camera-name">Camera Name *</label>
                        <input type="text" id="camera-name" style="width: 100%; padding: 12px 16px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;" required>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="camera-location">Location *</label>
                        <input type="text" id="camera-location" style="width: 100%; padding: 12px 16px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;" required>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="camera-assigned">Assigned To</label>
                        <select id="camera-assigned" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; background: white;">
                            <option value="">Select contractor...</option>
                            <option value="John Smith">John Smith</option>
                            <option value="Mike Johnson">Mike Johnson</option>
                            <option value="Sarah Wilson">Sarah Wilson</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="camera-priority">Priority</label>
                        <select id="camera-priority" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; background: white;">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>

                <input type="hidden" id="camera-id">
            </form>

            <div style="display: flex; gap: 12px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                <button type="button" onclick="saveCamera()" style="flex: 1; padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; background: #2563eb; color: white;">
                    Save Camera
                </button>
                <button type="button" onclick="closeModal('camera-modal')" style="flex: 1; padding: 12px 20px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; background: #f1f5f9; color: #475569;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let currentPage = 'dashboard';
        let selectedTask = null;
        let selectedCamera = null;

        // Extended sample data
        let cameras = [
            {
                id: 'CAM001',
                name: 'Front Entrance Camera',
                location: 'Main Entrance - Building A',
                assignedTo: 'John Smith',
                priority: 'high',
                status: 'overdue',
                lastChecked: '2025-05-28',
                inspectionNotes: 'Previous check: lens cleaned, all functions normal',
                retired: false
            },
            {
                id: 'CAM002',
                name: 'Parking Lot Camera A',
                location: 'North Parking Area',
                assignedTo: 'John Smith',
                priority: 'medium',
                status: 'overdue',
                lastChecked: '2025-05-15',
                inspectionNotes: 'Previous check: slight dirt on lens',
                retired: false
            },
            {
                id: 'CAM003',
                name: 'Loading Bay Camera',
                location: 'Service Entrance - Dock 3',
                assignedTo: 'John Smith',
                priority: 'low',
                status: 'recent',
                lastChecked: '2025-06-04',
                inspectionNotes: 'Previous check: clear view, good condition',
                retired: false
            },
            {
                id: 'CAM004',
                name: 'Emergency Exit Camera',
                location: 'East Wing - Fire Exit 2',
                assignedTo: 'Mike Johnson',
                priority: 'high',
                status: 'overdue',
                lastChecked: '2025-05-20',
                inspectionNotes: '',
                retired: false
            },
            {
                id: 'CAM005',
                name: 'Reception Area Camera',
                location: 'Main Lobby - Visitor Desk',
                assignedTo: 'Sarah Wilson',
                priority: 'medium',
                status: 'due-soon',
                lastChecked: '2025-06-01',
                inspectionNotes: 'Previous check: functioning normally',
                retired: false
            },
            {
                id: 'CAM006',
                name: 'Warehouse Camera 1',
                location: 'Warehouse Section A',
                assignedTo: 'Mike Johnson',
                priority: 'medium',
                status: 'recent',
                lastChecked: '2025-05-30',
                inspectionNotes: 'Working well, good coverage',
                retired: false
            }
        ];

        let tasks = [
            {
                id: 'TASK001',
                title: 'Clean lens on front entrance camera',
                description: 'Lens appears dirty from recent inspection, needs cleaning',
                type: 'maintenance',
                assignedTo: 'John Smith',
                createdBy: 'Sarah Wilson',
                priority: 'high',
                status: 'pending',
                dueDate: '2025-06-05',
                createdDate: '2025-06-04',
                completedDate: null,
                relatedCamera: 'CAM001',
                notes: ''
            },
            {
                id: 'TASK002',
                title: 'Replace power supply unit',
                description: 'Emergency exit camera power supply failing intermittently',
                type: 'repair',
                assignedTo: 'Mike Johnson',
                createdBy: 'Sarah Wilson',
                priority: 'high',
                status: 'in-progress',
                dueDate: '2025-06-06',
                createdDate: '2025-06-03',
                completedDate: null,
                relatedCamera: 'CAM004',
                notes: 'Ordered replacement part'
            },
            {
                id: 'TASK003',
                title: 'Monthly inspection report',
                description: 'Complete monthly inspection documentation for all active cameras',
                type: 'documentation',
                assignedTo: 'John Smith',
                createdBy: 'John Smith',
                priority: 'medium',
                status: 'pending',
                dueDate: '2025-06-07',
                createdDate: '2025-06-04',
                completedDate: null,
                relatedCamera: null,
                notes: ''
            },
            {
                id: 'TASK004',
                title: 'Install new warehouse camera',
                description: 'Install additional camera in warehouse section B',
                type: 'installation',
                assignedTo: 'Mike Johnson',
                createdBy: 'Sarah Wilson',
                priority: 'medium',
                status: 'completed',
                dueDate: '2025-06-03',
                createdDate: '2025-06-01',
                completedDate: '2025-06-03',
                relatedCamera: null,
                notes: 'Installation completed successfully'
            },
            {
                id: 'TASK005',
                title: 'Update camera firmware',
                description: 'Update firmware on all Hikvision cameras to latest version',
                type: 'upgrade',
                assignedTo: 'John Smith',
                createdBy: 'Sarah Wilson',
                priority: 'low',
                status: 'completed',
                dueDate: '2025-06-03',
                createdDate: '2025-06-01',
                completedDate: '2025-06-03',
                relatedCamera: null,
                notes: 'Completed successfully, all cameras updated'
            },
            {
                id: 'TASK006',
                title: 'Check network connectivity',
                description: 'Verify network connectivity for all IP cameras',
                type: 'maintenance',
                assignedTo: null,
                createdBy: 'Sarah Wilson',
                priority: 'medium',
                status: 'pending',
                dueDate: '2025-06-08',
                createdDate: '2025-06-04',
                completedDate: null,
                relatedCamera: null,
                notes: ''
            }
        ];

        let users = [
            {
                id: 'USER001',
                name: 'John Smith',
                email: 'john@securetech.com',
                role: 'contractor',
                company: 'SecureTech Ltd',
                status: 'active',
                lastLogin: '2025-06-04'
            },
            {
                id: 'USER002',
                name: 'Sarah Wilson',
                email: 'admin@site.com',
                role: 'admin',
                company: 'Site Management',
                status: 'active',
                lastLogin: '2025-06-04'
            },
            {
                id: 'USER003',
                name: 'Mike Johnson',
                email: 'mike@contractors.com',
                role: 'contractor',
                company: 'Security Solutions',
                status: 'active',
                lastLogin: '2025-06-03'
            },
            {
                id: 'USER004',
                name: 'Emma Davis',
                email: 'emma@sitemanage.com',
                role: 'manager',
                company: 'Site Management',
                status: 'active',
                lastLogin: '2025-06-02'
            },
            {
                id: 'USER005',
                name: 'Tom Wilson',
                email: 'tom@newcompany.com',
                role: 'contractor',
                company: 'New Security Co',
                status: 'pending',
                lastLogin: 'Never'
            }
        ];

        function loginAs(role) {
            if (role === 'admin') {
                currentUser = {
                    name: 'Sarah Wilson',
                    role: 'admin',
                    company: 'Site Management'
                };
            } else {
                currentUser = {
                    name: 'John Smith',
                    role: 'contractor',
                    company: 'SecureTech Ltd'
                };
            }
            
            showMainApp();
        }

        function showMainApp() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            
            updateUserInterface();
            updateNavigation();
            updateStats();
            renderContent();
        }

        function logout() {
            currentUser = null;
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
        }

        function updateUserInterface() {
            document.getElementById('current-user-name').textContent = currentUser.name;
            document.getElementById('current-user-role').textContent = currentUser.role.toUpperCase();
            document.getElementById('current-user-avatar').textContent = currentUser.name.split(' ').map(n => n[0]).join('');
            
            const roleClass = currentUser.role === 'admin' ? 'admin-badge' : 'contractor-badge';
            document.getElementById('current-user-role').className = 'user-role-badge ' + roleClass;
        }

        function updateNavigation() {
            if (currentUser.role === 'admin') {
                document.getElementById('contractor-nav').classList.add('hidden');
                document.getElementById('admin-nav').classList.remove('hidden');
                document.getElementById('app-title').textContent = 'CCTV Admin Portal';
                navigateTo('admin-dashboard');
            } else {
                document.getElementById('admin-nav').classList.add('hidden');
                document.getElementById('contractor-nav').classList.remove('hidden');
                document.getElementById('app-title').textContent = 'CCTV Contractor Portal';
                navigateTo('dashboard');
            }
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            const activeCameras = cameras.filter(c => !c.retired);
            
            if (currentUser.role === 'contractor') {
                const assigned = activeCameras.filter(c => c.assignedTo === currentUser.name).length;
                const checkedToday = activeCameras.filter(c => c.lastChecked === today && c.assignedTo === currentUser.name).length;
                const overdue = activeCameras.filter(c => c.status === 'overdue' && c.assignedTo === currentUser.name).length;
                const myTasks = tasks.filter(t => t.assignedTo === currentUser.name || t.createdBy === currentUser.name);
                
                const statAssigned = document.getElementById('stat-assigned');
                const statChecked = document.getElementById('stat-checked');
                const statOverdue = document.getElementById('stat-overdue');
                const statTasks = document.getElementById('stat-tasks');
                
                if (statAssigned) statAssigned.textContent = assigned;
                if (statChecked) statChecked.textContent = checkedToday;
                if (statOverdue) statOverdue.textContent = overdue;
                if (statTasks) statTasks.textContent = myTasks.length;
                
                const navAssigned = document.getElementById('nav-assigned-count');
                const navOverdue = document.getElementById('nav-overdue-count');
                const navCompleted = document.getElementById('nav-completed-count');
                const navTasks = document.getElementById('nav-my-tasks-count');
                
                if (navAssigned) navAssigned.textContent = assigned;
                if (navOverdue) navOverdue.textContent = overdue;
                if (navCompleted) navCompleted.textContent = checkedToday;
                if (navTasks) navTasks.textContent = myTasks.length;
                
                // Update my tasks stats
                const myTasksPage = document.getElementById('my-tasks-total');
                if (myTasksPage) {
                    const pending = myTasks.filter(t => t.status === 'pending' || t.status === 'in-progress').length;
                    const completed = myTasks.filter(t => t.status === 'completed').length;
                    const taskOverdue = myTasks.filter(t => t.dueDate < today && t.status !== 'completed').length;
                    
                    myTasksPage.textContent = myTasks.length;
                    const myPending = document.getElementById('my-tasks-pending');
                    const myCompleted = document.getElementById('my-tasks-completed');
                    const myOverdue = document.getElementById('my-tasks-overdue');
                    
                    if (myPending) myPending.textContent = pending;
                    if (myCompleted) myCompleted.textContent = completed;
                    if (myOverdue) myOverdue.textContent = taskOverdue;
                }
            } else {
                const totalCameras = cameras.length;
                const activeCount = activeCameras.length;
                const overdue = activeCameras.filter(c => c.status === 'overdue').length;
                
                const adminCameras = document.getElementById('admin-stat-cameras');
                const adminActive = document.getElementById('admin-stat-active');
                const adminOverdue = document.getElementById('admin-stat-overdue');
                const adminTasks = document.getElementById('admin-stat-tasks');
                
                if (adminCameras) adminCameras.textContent = totalCameras;
                if (adminActive) adminActive.textContent = activeCount;
                if (adminOverdue) adminOverdue.textContent = overdue;
                if (adminTasks) adminTasks.textContent = tasks.length;
                
                const navCameras = document.getElementById('nav-total-cameras');
                const navUsers = document.getElementById('nav-total-users');
                const navAllTasks = document.getElementById('nav-all-tasks-count');
                
                if (navCameras) navCameras.textContent = totalCameras;
                if (navUsers) navUsers.textContent = users.length;
                if (navAllTasks) navAllTasks.textContent = tasks.length;
                
                // Update all tasks stats
                const allTasksPage = document.getElementById('all-tasks-total');
                if (allTasksPage) {
                    const pending = tasks.filter(t => t.status === 'pending' || t.status === 'in-progress').length;
                    const completed = tasks.filter(t => t.status === 'completed').length;
                    const taskOverdue = tasks.filter(t => t.dueDate < today && t.status !== 'completed').length;
                    
                    allTasksPage.textContent = tasks.length;
                    const allPending = document.getElementById('all-tasks-pending');
                    const allCompleted = document.getElementById('all-tasks-completed');
                    const allOverdue = document.getElementById('all-tasks-overdue');
                    
                    if (allPending) allPending.textContent = pending;
                    if (allCompleted) allCompleted.textContent = completed;
                    if (allOverdue) allOverdue.textContent = taskOverdue;
                }

                // Update overview stats
                const overviewPage = document.getElementById('overview-stat-total');
                if (overviewPage) {
                    const pending = tasks.filter(t => t.status === 'pending' || t.status === 'in-progress').length;
                    const completed = tasks.filter(t => t.status === 'completed').length;
                    const taskOverdue = tasks.filter(t => t.dueDate < today && t.status !== 'completed').length;
                    
                    overviewPage.textContent = tasks.length;
                    const overviewPending = document.getElementById('overview-stat-pending');
                    const overviewCompleted = document.getElementById('overview-stat-completed');
                    const overviewOverdue = document.getElementById('overview-stat-overdue');
                    
                    if (overviewPending) overviewPending.textContent = pending;
                    if (overviewCompleted) overviewCompleted.textContent = completed;
                    if (overviewOverdue) overviewOverdue.textContent = taskOverdue;
                }
            }
        }

        function navigateTo(page) {
            document.querySelectorAll('[id$="-page"]').forEach(p => p.classList.add('hidden'));
            document.getElementById(page + '-page').classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            currentPage = page;
            renderContent();
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }
        }

        function renderContent() {
            switch(currentPage) {
                case 'dashboard':
                    renderDashboard();
                    break;
                case 'admin-dashboard':
                    renderAdminDashboard();
                    break;
                case 'my-cameras':
                    renderMyCameras();
                    break;
                case 'overdue':
                    renderOverdue();
                    break;
                case 'completed':
                    renderCompleted();
                    break;
                case 'my-tasks':
                    renderMyTasks();
                    break;
                case 'camera-management':
                    renderCameraManagement();
                    break;
                case 'all-cameras':
                    renderAllCameras();
                    break;
                case 'all-tasks':
                    renderAllTasks();
                    break;
                case 'task-overview':
                    renderTaskOverview();
                    break;
                case 'users':
                    renderUsers();
                    break;
            }
        }

        function renderDashboard() {
            const container = document.getElementById('dashboard-grid');
            const myCameras = cameras.filter(c => c.assignedTo === currentUser.name && !c.retired).slice(0, 3);
            const myTasks = tasks.filter(t => t.assignedTo === currentUser.name || t.createdBy === currentUser.name).slice(0, 2);
            
            const items = [...myCameras.map(c => ({...c, type: 'camera'})), ...myTasks.map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderAdminDashboard() {
            const container = document.getElementById('admin-dashboard-grid');
            const recentCameras = cameras.slice(0, 3);
            const recentTasks = tasks.slice(0, 3);
            
            const items = [...recentCameras.map(c => ({...c, type: 'camera'})), ...recentTasks.map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderMyCameras() {
            const container = document.getElementById('my-cameras-grid');
            const myCameras = cameras.filter(c => c.assignedTo === currentUser.name && !c.retired);
            container.innerHTML = myCameras.map(c => createItemCard({...c, type: 'camera'})).join('');
        }

        function renderOverdue() {
            const container = document.getElementById('overdue-grid');
            const today = new Date().toISOString().split('T')[0];
            const overdueCameras = cameras.filter(c => c.status === 'overdue' && (currentUser.role === 'admin' || c.assignedTo === currentUser.name));
            const overdueTasks = tasks.filter(t => (t.assignedTo === currentUser.name || currentUser.role === 'admin') && t.dueDate < today && t.status !== 'completed');
            
            const items = [...overdueCameras.map(c => ({...c, type: 'camera'})), ...overdueTasks.map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderCompleted() {
            const container = document.getElementById('completed-grid');
            const today = new Date().toISOString().split('T')[0];
            const completedCameras = cameras.filter(c => c.lastChecked === today && (currentUser.role === 'admin' || c.assignedTo === currentUser.name));
            const completedTasks = tasks.filter(t => (t.assignedTo === currentUser.name || currentUser.role === 'admin') && t.completedDate === today);
            
            const items = [...completedCameras.map(c => ({...c, type: 'camera'})), ...completedTasks.map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderMyTasks() {
            const container = document.getElementById('my-tasks-grid');
            const myTasks = tasks.filter(t => t.assignedTo === currentUser.name || t.createdBy === currentUser.name);
            container.innerHTML = myTasks.map(t => createItemCard({...t, type: 'task'})).join('');
        }

        function renderCameraManagement() {
            const container = document.getElementById('camera-management-grid');
            container.innerHTML = cameras.map(c => createItemCard({...c, type: 'camera'})).join('');
        }

        function renderAllCameras() {
            const tbody = document.getElementById('cameras-table-body');
            if (!tbody) return;
            
            tbody.innerHTML = cameras.map(camera => {
                return '<tr>' +
                    '<td style="font-weight: 500;">' + camera.name + '</td>' +
                    '<td>' + camera.location + '</td>' +
                    '<td>' + (camera.assignedTo || 'Unassigned') + '</td>' +
                    '<td>' + getStatusBadge(camera.status) + '</td>' +
                    '<td>' + (camera.lastChecked ? formatDate(camera.lastChecked) : 'Never') + '</td>' +
                    '<td>' +
                    '<div style="display: flex; gap: 8px;">' +
                    '<button onclick="editCamera(\'' + camera.id + '\')" style="padding: 4px 8px; border: none; background: none; border-radius: 4px; cursor: pointer; color: #2563eb;">✏️</button>' +
                    '</div>' +
                    '</td>' +
                    '</tr>';
            }).join('');
        }

        function filterCameraTable() {
            const searchInput = document.getElementById('camera-search');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            const rows = document.querySelectorAll('#cameras-table-body tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matches = text.includes(searchTerm);
                row.style.display = matches ? '' : 'none';
            });
        }

        function renderAllTasks() {
            const container = document.getElementById('all-tasks-grid');
            container.innerHTML = tasks.map(t => createItemCard({...t, type: 'task'})).join('');
        }

        function renderTaskOverview() {
            const container = document.getElementById('overview-tasks-grid');
            container.innerHTML = tasks.slice(0, 6).map(t => createItemCard({...t, type: 'task'})).join('');
        }

        function renderUsers() {
            const container = document.getElementById('users-grid');
            container.innerHTML = users.map(u => createItemCard({...u, type: 'user'})).join('');
        }

        function createItemCard(item) {
            if (item.type === 'camera') {
                return createCameraCard(item);
            } else if (item.type === 'task') {
                return createTaskCard(item);
            } else if (item.type === 'user') {
                return createUserCard(item);
            }
        }

        function createCameraCard(camera) {
            const today = new Date().toISOString().split('T')[0];
            const isCheckedToday = camera.lastChecked === today;
            const canCheck = !camera.retired && ((currentUser.role === 'admin') || (currentUser.role === 'contractor' && camera.assignedTo === currentUser.name && !isCheckedToday));
            const isAdmin = currentUser.role === 'admin';
            
            return '<div class="item-card">' +
                '<div class="item-header">' +
                '<div class="item-info">' +
                '<div class="item-title">' +
                '<span style="font-size: 18px;">📷</span>' +
                '<h3>' + camera.name + '</h3>' +
                '</div>' +
                '<div class="item-location">' +
                '<span style="font-size: 12px; margin-right: 4px;">📍</span>' +
                '<span>' + camera.location + '</span>' +
                '</div>' +
                '<div class="item-badges">' +
                getStatusBadge(camera.status) +
                getPriorityBadge(camera.priority) +
                '</div>' +
                '</div>' +
                '<div style="color: ' + (camera.status === 'overdue' ? '#dc2626' : '#059669') + '; font-size: 20px;">' +
                (camera.status === 'overdue' ? '⚠️' : '✅') +
                '</div>' +
                '</div>' +
                '<div class="item-details">' +
                '<div class="detail-row">' +
                '<span class="detail-label">Assigned To:</span>' +
                '<span class="detail-value">' + (camera.assignedTo || 'Unassigned') + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Last Checked:</span>' +
                '<span class="detail-value">' + (camera.lastChecked ? formatDate(camera.lastChecked) : 'Never') + '</span>' +
                '</div>' +
                (camera.inspectionNotes ? 
                    '<div>' +
                    '<span class="detail-label">Previous Notes:</span>' +
                    '<div class="previous-notes">' + camera.inspectionNotes + '</div>' +
                    '</div>' : ''
                ) +
                '</div>' +
                (canCheck ? 
                    '<button class="action-button-full enabled" onclick="performCheck(\'' + camera.id + '\')">Perform Check</button>' :
                    '<button class="action-button-full disabled" disabled>' + (isCheckedToday ? 'Checked Today' : 'Not Available') + '</button>'
                ) +
                (isAdmin ? 
                    '<div class="admin-actions">' +
                    '<button class="admin-btn edit" onclick="editCamera(\'' + camera.id + '\')">✏️ Edit</button>' +
                    '</div>' : ''
                ) +
                '</div>';
        }

        function createTaskCard(task) {
            const today = new Date().toISOString().split('T')[0];
            const isOverdue = task.dueDate && task.dueDate < today && task.status !== 'completed';
            const canComplete = task.assignedTo === currentUser.name && task.status !== 'completed';
            const canEdit = currentUser.role === 'admin' || task.createdBy === currentUser.name || task.assignedTo === currentUser.name;
            
            return '<div class="item-card">' +
                '<div class="item-header">' +
                '<div class="item-info">' +
                '<div class="item-title">' +
                '<span style="font-size: 18px;">📋</span>' +
                '<h3>' + task.title + '</h3>' +
                '</div>' +
                '<div class="item-location">' +
                '<span style="font-size: 12px; margin-right: 4px;">🏷️</span>' +
                '<span>' + task.type.charAt(0).toUpperCase() + task.type.slice(1) + '</span>' +
                '</div>' +
                '<div class="item-badges">' +
                getTaskStatusBadge(task.status, isOverdue) +
                getPriorityBadge(task.priority) +
                '</div>' +
                '</div>' +
                '<div style="color: ' + getTaskStatusColor(task.status, isOverdue) + '; font-size: 20px;">' +
                getTaskStatusIcon(task.status, isOverdue) +
                '</div>' +
                '</div>' +
                '<div class="item-details">' +
                (task.description ? 
                    '<div style="margin-bottom: 12px;">' +
                    '<span class="detail-label">Description:</span>' +
                    '<div class="previous-notes">' + task.description + '</div>' +
                    '</div>' : ''
                ) +
                '<div class="detail-row">' +
                '<span class="detail-label">Assigned To:</span>' +
                '<span class="detail-value">' + (task.assignedTo || 'Unassigned') + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Due Date:</span>' +
                '<span class="detail-value ' + (isOverdue ? 'overdue' : '') + '">' +
                (task.dueDate ? formatDate(task.dueDate) : 'No due date') +
                '</span>' +
                '</div>' +
                '</div>' +
                '<div style="display: flex; gap: 8px;">' +
                (canComplete ? 
                    '<button class="action-button-full enabled" style="flex: 1;" onclick="completeTask(\'' + task.id + '\')">' + 
                    (task.status === 'in-progress' ? 'Complete Task' : 'Start Task') + '</button>' :
                    '<button class="action-button-full disabled" style="flex: 1;" disabled>' + 
                    (task.status === 'completed' ? 'Task Completed' : 'Not Available') + '</button>'
                ) +
                (canEdit ? 
                    '<button class="admin-btn edit" onclick="editTask(\'' + task.id + '\')" style="flex: 0 0 auto; padding: 12px;">✏️</button>' : ''
                ) +
                '</div>' +
                '</div>';
        }

        function createUserCard(user) {
            return '<div class="item-card">' +
                '<div class="item-header">' +
                '<div class="item-info">' +
                '<div class="item-title">' +
                '<span style="font-size: 18px;">👤</span>' +
                '<h3>' + user.name + '</h3>' +
                '</div>' +
                '<div class="item-location">' +
                '<span style="font-size: 12px; margin-right: 4px;">📧</span>' +
                '<span>' + user.email + '</span>' +
                '</div>' +
                '<div class="item-badges">' +
                '<span class="badge badge-' + user.role + '">' + user.role.toUpperCase() + '</span>' +
                '<span class="badge badge-' + user.status + '">' + user.status.toUpperCase() + '</span>' +
                '</div>' +
                '</div>' +
                '<div style="color: #059669; font-size: 20px;">👤</div>' +
                '</div>' +
                '<div class="item-details">' +
                '<div class="detail-row">' +
                '<span class="detail-label">Role:</span>' +
                '<span class="detail-value">' + user.role + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Company:</span>' +
                '<span class="detail-value">' + user.company + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Last Login:</span>' +
                '<span class="detail-value">' + (user.lastLogin !== 'Never' ? formatDate(user.lastLogin) : 'Never') + '</span>' +
                '</div>' +
                '</div>' +
                (currentUser.role === 'admin' ? 
                    '<button class="action-button-full enabled" onclick="editUser(\'' + user.id + '\')">Edit User</button>' :
                    '<button class="action-button-full disabled" disabled>View Only</button>'
                ) +
                '</div>';
        }

        function getStatusBadge(status) {
            switch(status) {
                case 'overdue': return '<span class="badge badge-overdue">OVERDUE</span>';
                case 'recent': return '<span class="badge badge-recent">RECENT</span>';
                case 'due-soon': return '<span class="badge badge-due-soon">DUE SOON</span>';
                default: return '<span class="badge badge-pending">PENDING</span>';
            }
        }

        function getTaskStatusBadge(status, isOverdue) {
            if (isOverdue && status !== 'completed') {
                return '<span class="badge badge-overdue">OVERDUE</span>';
            }
            switch(status) {
                case 'completed': return '<span class="badge badge-completed">COMPLETED</span>';
                case 'in-progress': return '<span class="badge badge-in-progress">IN PROGRESS</span>';
                case 'pending': return '<span class="badge badge-pending">PENDING</span>';
                default: return '<span class="badge badge-pending">PENDING</span>';
            }
        }

        function getPriorityBadge(priority) {
            return '<span class="badge badge-priority badge-' + priority + '">' + priority.toUpperCase() + '</span>';
        }

        function getTaskStatusColor(status, isOverdue) {
            if (isOverdue && status !== 'completed') return '#dc2626';
            switch(status) {
                case 'completed': return '#059669';
                case 'in-progress': return '#f59e0b';
                default: return '#64748b';
            }
        }

        function getTaskStatusIcon(status, isOverdue) {
            if (isOverdue && status !== 'completed') return '⚠️';
            switch(status) {
                case 'completed': return '✅';
                case 'in-progress': return '🔄';
                default: return '📋';
            }
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-GB');
        }

        // Task management functions
        function addNewTask() {
            selectedTask = null;
            const titleElement = document.getElementById('task-modal-title');
            const formElement = document.getElementById('task-form');
            const priorityElement = document.getElementById('task-priority');
            const dueDateElement = document.getElementById('task-due-date');
            const modalElement = document.getElementById('task-modal');
            
            if (titleElement) titleElement.textContent = 'Create New Task';
            if (formElement) formElement.reset();
            if (priorityElement) priorityElement.value = 'medium';
            
            // Set default due date to tomorrow
            if (dueDateElement) {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                dueDateElement.value = tomorrow.toISOString().split('T')[0];
            }
            
            if (modalElement) modalElement.classList.remove('hidden');
        }

        function editTask(taskId) {
            selectedTask = tasks.find(t => t.id === taskId);
            if (!selectedTask) return;
            
            const titleElement = document.getElementById('task-modal-title');
            const titleInput = document.getElementById('task-title');
            const typeInput = document.getElementById('task-type');
            const descInput = document.getElementById('task-description');
            const assignedInput = document.getElementById('task-assigned');
            const priorityInput = document.getElementById('task-priority');
            const dueDateInput = document.getElementById('task-due-date');
            const cameraInput = document.getElementById('task-camera');
            const idInput = document.getElementById('task-id');
            const modalElement = document.getElementById('task-modal');
            
            if (titleElement) titleElement.textContent = 'Edit Task';
            if (titleInput) titleInput.value = selectedTask.title;
            if (typeInput) typeInput.value = selectedTask.type;
            if (descInput) descInput.value = selectedTask.description;
            if (assignedInput) assignedInput.value = selectedTask.assignedTo || '';
            if (priorityInput) priorityInput.value = selectedTask.priority;
            if (dueDateInput) dueDateInput.value = selectedTask.dueDate || '';
            if (cameraInput) cameraInput.value = selectedTask.relatedCamera || '';
            if (idInput) idInput.value = selectedTask.id;
            
            if (modalElement) modalElement.classList.remove('hidden');
        }

        function saveTask() {
            const form = document.getElementById('task-form');
            if (!form || !form.checkValidity()) {
                if (form) form.reportValidity();
                return;
            }
            
            const titleInput = document.getElementById('task-title');
            const typeInput = document.getElementById('task-type');
            const descInput = document.getElementById('task-description');
            const assignedInput = document.getElementById('task-assigned');
            const priorityInput = document.getElementById('task-priority');
            const dueDateInput = document.getElementById('task-due-date');
            const cameraInput = document.getElementById('task-camera');
            
            if (!titleInput || !typeInput || !priorityInput) return;
            
            const taskData = {
                title: titleInput.value,
                type: typeInput.value,
                description: descInput ? descInput.value : '',
                assignedTo: assignedInput ? (assignedInput.value || null) : null,
                priority: priorityInput.value,
                dueDate: dueDateInput ? (dueDateInput.value || null) : null,
                relatedCamera: cameraInput ? (cameraInput.value || null) : null
            };
            
            if (selectedTask) {
                // Update existing task
                Object.assign(selectedTask, taskData);
            } else {
                // Add new task
                const newTask = {
                    id: 'TASK' + String(tasks.length + 1).padStart(3, '0'),
                    ...taskData,
                    createdBy: currentUser.name,
                    status: 'pending',
                    createdDate: new Date().toISOString().split('T')[0],
                    completedDate: null,
                    notes: ''
                };
                tasks.push(newTask);
            }
            
            closeModal('task-modal');
            updateStats();
            renderContent();
            
            alert('Task ' + (selectedTask ? 'updated' : 'created') + ' successfully!');
        }

        function completeTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (!task) return;
            
            if (task.status === 'pending') {
                task.status = 'in-progress';
                alert('Task "' + task.title + '" marked as in progress.');
            } else if (task.status === 'in-progress') {
                const notes = prompt('Add completion notes (optional):');
                task.status = 'completed';
                task.completedDate = new Date().toISOString().split('T')[0];
                if (notes) {
                    task.notes = notes;
                }
                alert('Task "' + task.title + '" completed successfully!');
            }
            
            updateStats();
            renderContent();
        }

        // Camera management functions
        function addNewCamera() {
            selectedCamera = null;
            document.getElementById('camera-modal-title').textContent = 'Add New Camera';
            document.getElementById('camera-form').reset();
            document.getElementById('camera-priority').value = 'medium';
            document.getElementById('camera-modal').classList.remove('hidden');
        }

        function editCamera(cameraId) {
            selectedCamera = cameras.find(c => c.id === cameraId);
            if (!selectedCamera) return;
            
            document.getElementById('camera-modal-title').textContent = 'Edit Camera';
            document.getElementById('camera-name').value = selectedCamera.name;
            document.getElementById('camera-location').value = selectedCamera.location;
            document.getElementById('camera-assigned').value = selectedCamera.assignedTo || '';
            document.getElementById('camera-priority').value = selectedCamera.priority;
            document.getElementById('camera-id').value = selectedCamera.id;
            
            document.getElementById('camera-modal').classList.remove('hidden');
        }

        function saveCamera() {
            const form = document.getElementById('camera-form');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const cameraData = {
                name: document.getElementById('camera-name').value,
                location: document.getElementById('camera-location').value,
                assignedTo: document.getElementById('camera-assigned').value || null,
                priority: document.getElementById('camera-priority').value
            };
            
            if (selectedCamera) {
                // Update existing camera
                Object.assign(selectedCamera, cameraData);
            } else {
                // Add new camera
                const newCamera = {
                    id: 'CAM' + String(cameras.length + 1).padStart(3, '0'),
                    ...cameraData,
                    status: 'pending',
                    lastChecked: null,
                    inspectionNotes: '',
                    retired: false
                };
                cameras.push(newCamera);
            }
            
            closeModal('camera-modal');
            updateStats();
            renderContent();
            
            alert('Camera ' + (selectedCamera ? 'updated' : 'added') + ' successfully!');
        }

        function performCheck(cameraId) {
            selectedCamera = cameras.find(c => c.id === cameraId);
            if (!selectedCamera) return;
            
            document.getElementById('check-modal-title').textContent = 'Check: ' + selectedCamera.name;
            document.getElementById('check-modal-subtitle').textContent = selectedCamera.location;
            
            // Reset form
            document.getElementById('check-working').checked = true;
            document.getElementById('check-lens').checked = true;
            document.getElementById('check-position').checked = true;
            document.getElementById('check-lighting').checked = true;
            document.getElementById('issues-found').checked = false;
            document.getElementById('issue-description').value = '';
            document.getElementById('additional-notes').value = '';
            document.getElementById('issue-description').classList.add('hidden');
            
            document.getElementById('check-modal').classList.remove('hidden');
        }

        function completeCheck() {
            if (!selectedCamera) return;
            
            const working = document.getElementById('check-working').checked;
            const lens = document.getElementById('check-lens').checked;
            const position = document.getElementById('check-position').checked;
            const lighting = document.getElementById('check-lighting').checked;
            const issuesFound = document.getElementById('issues-found').checked;
            const issueDescription = document.getElementById('issue-description').value;
            const additionalNotes = document.getElementById('additional-notes').value;
            
            if (!working || !lens || !position || !lighting) {
                alert('All status checks must be completed.');
                return;
            }
            
            if (issuesFound && !issueDescription.trim()) {
                alert('Please describe the issues found.');
                return;
            }
            
            const today = new Date().toISOString().split('T')[0];
            let notes = additionalNotes.trim();
            if (issuesFound && issueDescription.trim()) {
                notes += (notes ? ' - ' : '') + 'ISSUES: ' + issueDescription.trim();
            }
            
            selectedCamera.lastChecked = today;
            selectedCamera.inspectionNotes = notes || 'Check completed - no issues reported';
            selectedCamera.status = 'recent';
            
            closeModal('check-modal');
            updateStats();
            renderContent();
            
            alert('Check completed successfully for ' + selectedCamera.name);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
            }
            selectedTask = null;
            selectedCamera = null;
        }

        function addNewUser() {
            alert('User management feature coming soon!');
        }

        function editUser(userId) {
            alert('User editing feature coming soon!');
        }

        function exportCameraData() {
            alert('Export feature coming soon!');
        }

        function exportCheckReports() {
            alert('Export feature coming soon!');
        }

        function filterCameraTable() {
            const searchTerm = document.getElementById('camera-search').value.toLowerCase();
            const rows = document.querySelectorAll('#cameras-table-body tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matches = text.includes(searchTerm);
                row.style.display = matches ? '' : 'none';
            });
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Issues checkbox handler
            const issuesCheckbox = document.getElementById('issues-found');
            if (issuesCheckbox) {
                issuesCheckbox.addEventListener('change', function() {
                    const issueDescription = document.getElementById('issue-description');
                    if (this.checked) {
                        issueDescription.classList.remove('hidden');
                        issueDescription.required = true;
                    } else {
                        issueDescription.classList.add('hidden');
                        issueDescription.required = false;
                        issueDescription.value = '';
                    }
                });
            }

            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.add('hidden');
                    }
                });
            });

            // Responsive sidebar
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    document.getElementById('sidebar').classList.remove('open');
                }
            });
        });

        // Make functions globally available
        window.loginAs = loginAs;
        window.logout = logout;
        window.navigateTo = navigateTo;
        window.toggleSidebar = toggleSidebar;
        window.addNewTask = addNewTask;
        window.editTask = editTask;
        window.saveTask = saveTask;
        window.completeTask = completeTask;
        window.addNewCamera = addNewCamera;
        window.editCamera = editCamera;
        window.saveCamera = saveCamera;
        window.performCheck = performCheck;
        window.completeCheck = completeCheck;
        window.closeModal = closeModal;
        window.addNewUser = addNewUser;
        window.editUser = editUser;
        window.exportCameraData = exportCameraData;
        window.exportCheckReports = exportCheckReports;
        window.filterCameraTable = filterCameraTable;
    </script>
</body>
</html>    <!-- Camera Check Modal -->
    <div class="modal hidden" id="check-modal" style="position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; padding: 16px; z-index: 100;">
        <div style="background: white; border-radius: 16px; width: 100%; max-width: 600px; padding: 24px;">
            <div style="margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid #e2e8f0;">
                <h3 id="check-modal-title" style="font-size: 20px; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Camera Check</h3>
                <p id="check-modal-subtitle" style="font-size: 14px; color: #64748b;"></p>
            </div>

            <div style="margin-bottom: 24px;">
                <h4 style="font-size: 16px; font-weight: 600; color: #1e293b; margin-bottom: 12px;">Camera Status Check</h4>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <div style="display: flex; align-items: center; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <input type="checkbox" id="check-working" checked style="width: 18px; height: 18px; margin-right: 12px;">
                        <label for="check-working" style="font-size: 14px; color: #1e293b; cursor: pointer;">Camera is working and recording</label>
                    </div>
                    <div style="display: flex; align-items: center; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <input type="checkbox" id="check-lens" checked style="width: 18px; height: 18px; margin-right: 12px;">
                        <label for="check-lens" style="font-size: 14px; color: #1e293b; cursor: pointer;">Lens is clean and clear</label>
                    </div>
                    <div style="display: flex; align-items: center; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <input type="checkbox" id="check-position" checked style="width: 18px; height: 18px; margin-right: 12px;">
                        <label for="check-position" style="font-size: 14px; color: #1e293b; cursor: pointer;">Camera position is correct</label>
                    </div>
                    <div style="display: flex; align-items: center; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0;">
                        <input type="checkbox" id="check-lighting" checked style="width: 18px; height: 18px; margin-right: 12px;">
                        <label for="check-lighting" style="font-size: 14px; color: #1e293b; cursor: pointer;">Lighting is adequate</label>
                    </div>
                </div>
            </div>

            <div style="margin-bottom: 16px;">
                <div style="display: flex; align-items: center; padding: 12px; border-radius: 8px; border: 2px solid #fee2e2; background: #fef2f2;">
                    <input type="checkbox" id="issues-found" style="width: 18px; height: 18px; margin-right: 12px;">
                    <label for="issues-found" style="color: #dc2626; font-weight: 600; cursor: pointer;">Issues found</label>
                </div>
                <div style="margin-bottom: 16px;">
                    <textarea id="issue-description" class="hidden" rows="3" placeholder="Describe the issues found..." style="width: 100%; padding: 12px; border: 1px solid #fca5a5; background: #fef2f2; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit; margin-top: 8px;"></textarea>
                </div>
            </div>

            <div style="margin-bottom: 16px;">
                <label for="additional-notes" style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;">Additional Notes (Optional)</label>
                <textarea id="additional-notes" rows="3" placeholder="Any additional observations..." style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit;"></textarea>
            </div>

            <div style="display: flex; gap: 12px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                <button onclick="completeCheck()" style="flex: 1; padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; background: #059669; color: white;">
                    Complete Check
                </button>
                <button onclick="closeModal('check-                <!-- All Tasks Page -->
                <div id="all-tasks-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">All Tasks</h1>
                            <p class="content-subtitle">Manage all system tasks</p>
                        </div>
                        <div class="content-actions">
                            <button class="action-button primary" onclick="addNewTask()">
                                <span>➕</span>
                                Create Task
                            </button>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="all-tasks-total">12</div>
                                <div class="stat-label">Total Tasks</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="all-tasks-pending">5</div>
                                <div class="stat-label">Pending</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="all-tasks-completed">4</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="all-tasks-overdue">3</div>
                                <div class="stat-label">Overdue</div>
                            </div>
                        </div>
                        <div class="items-grid" id="all-tasks-grid"></div>
                    </div>
                </div>

                <!-- Completed Checks Page -->
                <div id="completed-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Today's Checks</h1>
                            <p class="content-subtitle">Cameras checked today</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="items-grid" id="completed-grid"></div>
                    </div>
                </div>

                <!-- All Cameras List Page -->
                <div id="all-cameras-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">All Cameras List</h1>
                            <p class="content-subtitle">Complete camera inventory</p>
                        </div>
                        <div class="content-actions">
                            <button class="action-button" onclick="exportCameraData()">
                                <span>📊</span>
                                Export Data
                            </button>
                            <button class="action-button primary" onclick="addNewCamera()">
                                <span>➕</span>
                                Add Camera
                            </button>
                        </div>
                    </div>
                    <div class="content-body">
                        <div style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; overflow: hidden;">
                            <div style="padding: 20px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="font-size: 18px; font-weight: 600; color: #1e293b;">Camera Inventory</h3>
                                <input type="text" placeholder="Search cameras..." id="camera-search" onkeyup="filterCameraTable()" style="padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px; width: 300px;">
                            </div>
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: #f8fafc;">
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; color: #374151; font-size: 12px; text-transform: uppercase;">Name</th>
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; color: #374151; font-size: 12px; text-transform: uppercase;">Location</th>
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; color: #374151; font-size: 12px; text-transform: uppercase;">Assigned To</th>
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; color: #374151; font-size: 12px; text-transform: uppercase;">Status</th>
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; color: #374151; font-size: 12px; text-transform: uppercase;">Last Check</th>
                                        <th style="text-align: left; padding: 12px 16px; font-weight: 600; color: #374151; font-size: 12px; text-transform: uppercase;">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="cameras-table-body">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Task Overview Page -->
                <div id="task-overview-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Task Overview</h1>
                            <p class="content-subtitle">Analytics and overview of all tasks</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="overview-stat-total">12</div>
                                <div class="stat-label">Total Tasks</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="overview-stat-pending">5</div>
                                <div class="stat-label">Pending</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="overview-stat-completed">4</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="overview-stat-overdue">3</div>
                                <div class="stat-label">Overdue</div>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px;">
                            <div style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px;">
                                <h3 style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 16px;">Tasks by Priority</h3>
                                <div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <span style="display: flex; align-items: center; gap: 8px;">
                                            <span class="badge badge-priority badge-high">HIGH</span>
                                            High Priority
                                        </span>
                                        <span style="font-weight: 600;">4</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <span style="display: flex; align-items: center; gap: 8px;">
                                            <span class="badge badge-priority badge-medium">MEDIUM</span>
                                            Medium Priority
                                        </span>
                                        <span style="font-weight: 600;">6</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span style="display: flex; align-items: center; gap: 8px;">
                                            <span class="badge badge-priority badge-low">LOW</span>
                                            Low Priority
                                        </span>
                                        <span style="font-weight: 600;">2</span>
                                    </div>
                                </div>
                            </div>

                            <div style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px;">
                                <h3 style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 16px;">Tasks by User</h3>
                                <div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <span>John Smith</span>
                                        <span style="font-weight: 600;">4</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <span>Mike Johnson</span>
                                        <span style="font-weight: 600;">3</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <span>Sarah Wilson</span>
                                        <span style="font-weight: 600;">2</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <span>Unassigned</span>
                                        <span style="font-weight: 600; color: #dc2626;">3</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="items-grid" id="overview-tasks-grid"></div>
                    </div>
                </div>

                <!-- History Page -->
                <div id="history-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Check History</h1>
                            <p class="content-subtitle">Your recent inspection history</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px;">
                            <h3 style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 20px;">Recent Check History</h3>
                            <div style="space-y: 16px;">
                                <div style="border-bottom: 1px solid #f1f5f9; padding-bottom: 16px; margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h4 style="font-weight: 600; color: #1e293b;">Loading Bay Camera</h4>
                                            <p style="color: #64748b; font-size: 14px;">Service Entrance - Dock 3</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-completed">PASS</span>
                                            <p style="color: #64748b; font-size: 12px; margin-top: 4px;">04/06/2025</p>
                                        </div>
                                    </div>
                                </div>
                                <div style="border-bottom: 1px solid #f1f5f9; padding-bottom: 16px; margin-bottom: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h4 style="font-weight: 600; color: #1e293b;">Front Entrance Camera</h4>
                                            <p style="color: #64748b; font-size: 14px;">Main Entrance - Building A</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-overdue">ISSUES</span>
                                            <p style="color: #64748b; font-size: 12px; margin-top: 4px;">02/06/2025</p>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h4 style="font-weight: 600; color: #1e293b;">Parking Lot Camera A</h4>
                                            <p style="color: #64748b; font-size: 14px;">North Parking Area</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <span class="badge badge-completed">PASS</span>
                                            <p style="color: #64748b; font-size: 12px; margin-top: 4px;">01/06/2025</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Check Reports Page -->
                <div id="all-checks-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">All Check Reports</h1>
                            <p class="content-subtitle">Complete history of camera inspections</p>
                        </div>
                        <div class="content-actions">
                            <button class="action-button" onclick="exportCheckReports()">
                                <span>📊</span>
                                Export Reports
                            </button>
                        </div>
                    </div>
                    <div class="content-body">
                        <div style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px;">
                            <h3 style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 20px;">All Inspection Reports</h3>
                            <div>
                                <div style="border-bottom: 1px solid #f1f5f9; padding: 12px 0;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; align-items: center;">
                                        <div>
                                            <div style="font-weight: 600;">Loading Bay Camera</div>
                                            <div style="font-size: 12px; color: #64748b;">John Smith</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <span class="badge badge-completed">PASS</span>
                                        </div>
                                        <div style="text-align: center; color: #64748b; font-size: 14px;">
                                            04/06/2025
                                        </div>
                                        <div style="text-align: right; color: #64748b; font-size: 14px;">
                                            Clear view, good condition
                                        </div>
                                    </div>
                                </div>
                                <div style="border-bottom: 1px solid #f1f5f9; padding: 12px 0;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 16px; align-items: center;">
                                        <div>
                                            <div style="font-weight: 600;">Front Entrance Camera</div>
                                            <div style="font-size: 12px; color: #64748b;">John Smith</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <span class="badge badge-overdue">ISSUES</span>
                                        </div>
                                        <div style="text-align: center; color: #64748b; font-size: 14px;">
                                            02/06/2025
                                        </div>
                                        <div style="text-align: right; color: #dc2626; font-size: 14px;">
                                            Lens requires cleaning
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Issues Page -->
                <div id="issues-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Issue Tracking</h1>
                            <p class="content-subtitle">Track and manage camera issues</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-red">
                                <div class="stat-number">5</div>
                                <div class="stat-label">Open Issues</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number">12</div>
                                <div class="stat-label">In Progress</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number">43</div>
                                <div class="stat-label">Resolved This Month</div>
                            </div>
                        </div>

                        <div style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 24px;">
                            <h3 style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 20px;">Recent Issues</h3>
                            <div>
                                <div style="border-bottom: 1px solid #f1f5f9; padding: 12px 0;">
                                    <div style="display: grid; grid-template-columns: auto 1fr auto auto; gap: 16px; align-items: center;">
                                        <div style="font-weight: 600;">#ISS-001</div>
                                        <div>
                                            <div style="font-weight: 600;">Front Entrance Camera - Lens Obstruction</div>
                                            <div style="font-size: 12px; color: #64748b;">Assigned to John Smith</div>
                                        </div>
                                        <span class="badge badge-priority badge-high">HIGH</span>
                                        <span class="badge badge-overdue">OPEN</span>
                                    </div>
                                </div>
                                <div style="border-bottom: 1px solid #f1f5f9; padding: 12px 0;">
                                    <div style="display: grid; grid-template-columns: auto 1fr auto auto; gap: 16px; align-items: center;">
                                        <div style="font-weight: 600;">#ISS-002</div>
                                        <div>
                                            <div style="font-weight: 600;">Parking Lot Camera A - Connection Issues</div>
                                            <div style="font-size: 12px; color: #64748b;">Assigned to Mike Johnson</div>
                                        </div>
                                        <span class="badge badge-priority badge-medium">MEDIUM</span>
                                        <span class="badge badge-in-progress">IN PROGRESS</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="users-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">User Management</h1>
                            <p class="content-subtitle">Manage users and permissions</p>
                        </div>
                        <div class="content-actions">
                            <button class="action-button primary" onclick="addNewUser()">
                                <span>👤</span>
                                Add User
                            </button>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="items-grid" id="users-grid"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="modal hidden" id="task-modal" style="position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; padding: 16px; z-index: 100;">
        <div style="background: white; border-radius: 16px; width: 100%; max-width: 600px; padding: 24px; max-height: 90vh; overflow-y: auto;">
            <div style="margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid #e2e8f0;">
                <h3 id="task-modal-title" style="font-size: 20px; font-weight: 700; color: #1e293b; margin-bottom: 4px;">Create New Task</h3>
                <p style="font-size: 14px; color: #64748b;">Task details and assignment</p>
            </div>

            <form id="task-form">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-title">Task Title *</label>
                        <input type="text" id="task-title" style="width: 100%; padding: 12px 16px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;" required>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-type">Task Type *</label>
                        <select id="task-type" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; background: white;" required>
                            <option value="">Select type...</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="inspection">Inspection</option>
                            <option value="repair">Repair</option>
                            <option value="installation">Installation</option>
                            <option value="upgrade">Upgrade</option>
                            <option value="documentation">Documentation</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>

                <div style="margin-bottom: 16px;">
                    <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-description">Description</label>
                    <textarea id="task-description" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; resize: vertical; font-family: inherit;" rows="3" placeholder="Detailed task description..."></textarea>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-assigned">Assigned To</label>
                        <select id="task-assigned" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; background: white;">
                            <option value="">Select assignee...</option>
                            <option value="John Smith">John Smith</option>
                            <option value="Mike Johnson">Mike Johnson</option>
                            <option value="Sarah Wilson">Sarah Wilson</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-priority">Priority *</label>
                        <select id="task-priority" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; background: white;" required>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-due-date">Due Date</label>
                        <input type="date" id="task-due-date" style="width: 100%; padding: 12px 16px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;">
                    </div>
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;" for="task-camera">Related Camera</label>
                        <select id="task-camera" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; background: white;">
                            <option value="">Select camera...</option>
                            <option value="CAM001">Front Entrance Camera</option>
                            <option value="CAM002">Parking Lot Camera A</option>
                            <option value="CAM003">Loading Bay Camera</option>
                        </select>
                    </div>
                </div>

                <input type="hidden" id="task-id">
            </form>

            <div style="display: flex; gap: 12px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                <button type="button" onclick="saveTask()" style="flex: 1; padding: 12px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; background: #2563eb; color: white;">
                    Save Task
                </button>
                <button type="button" onclick="closeModal('task-modal')" style="flex: 1; padding: 12px 20px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; background: #f1f5f9; color: #475569;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let currentPage = 'dashboard';
        let selectedTask = null;

        // Sample data
        let cameras = [
            {
                id: 'CAM001',
                name: 'Front Entrance Camera',
                location: 'Main Entrance - Building A',
                assignedTo: 'John Smith',
                priority: 'high',
                status: 'overdue',
                lastChecked: '2025-05-28',
                retired: false
            },
            {
                id: 'CAM002',
                name: 'Parking Lot Camera A',
                location: 'North Parking Area',
                assignedTo: 'John Smith',
                priority: 'medium',
                status: 'overdue',
                lastChecked: '2025-05-15',
                retired: false
            },
            {
                id: 'CAM003',
                name: 'Loading Bay Camera',
                location: 'Service Entrance - Dock 3',
                assignedTo: 'John Smith',
                priority: 'low',
                status: 'recent',
                lastChecked: '2025-06-04',
                retired: false
            }
        ];

        let tasks = [
            {
                id: 'TASK001',
                title: 'Clean lens on front entrance camera',
                description: 'Lens appears dirty from recent inspection',
                type: 'maintenance',
                assignedTo: 'John Smith',
                createdBy: 'Sarah Wilson',
                priority: 'high',
                status: 'pending',
                dueDate: '2025-06-05',
                createdDate: '2025-06-04',
                relatedCamera: 'CAM001'
            },
            {
                id: 'TASK002',
                title: 'Replace power supply unit',
                description: 'Emergency exit camera power supply failing',
                type: 'repair',
                assignedTo: 'Mike Johnson',
                createdBy: 'Sarah Wilson',
                priority: 'high',
                status: 'in-progress',
                dueDate: '2025-06-06',
                createdDate: '2025-06-03',
                relatedCamera: null
            },
            {
                id: 'TASK003',
                title: 'Monthly inspection report',
                description: 'Complete monthly documentation',
                type: 'documentation',
                assignedTo: 'John Smith',
                createdBy: 'John Smith',
                priority: 'medium',
                status: 'pending',
                dueDate: '2025-06-07',
                createdDate: '2025-06-04',
                relatedCamera: null
            },
            {
                id: 'TASK004',
                title: 'Install new warehouse camera',
                description: 'Install additional camera in warehouse section B',
                type: 'installation',
                assignedTo: 'Mike Johnson',
                createdBy: 'Sarah Wilson',
                priority: 'medium',
                status: 'completed',
                dueDate: '2025-06-03',
                createdDate: '2025-06-01',
                relatedCamera: null
            }
        ];

        let users = [
            {
                id: 'USER001',
                name: 'John Smith',
                email: 'john@securetech.com',
                role: 'contractor',
                company: 'SecureTech Ltd',
                status: 'active'
            },
            {
                id: 'USER002',
                name: 'Sarah Wilson',
                email: 'admin@site.com',
                role: 'admin',
                company: 'Site Management',
                status: 'active'
            },
            {
                id: 'USER003',
                name: 'Mike Johnson',
                email: 'mike@contractors.com',
                role: 'contractor',
                company: 'Security Solutions',
                status: 'active'
            }
        ];

        function loginAs(role) {
            if (role === 'admin') {
                currentUser = {
                    name: 'Sarah Wilson',
                    role: 'admin',
                    company: 'Site Management'
                };
            } else {
                currentUser = {
                    name: 'John Smith',
                    role: 'contractor',
                    company: 'SecureTech Ltd'
                };
            }
            
            showMainApp();
        }

        function showMainApp() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            
            updateUserInterface();
            updateNavigation();
            updateStats();
            renderContent();
        }

        function logout() {
            currentUser = null;
            document.getElementById('main-app').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
        }

        function updateUserInterface() {
            document.getElementById('current-user-name').textContent = currentUser.name;
            document.getElementById('current-user-role').textContent = currentUser.role.toUpperCase();
            document.getElementById('current-user-avatar').textContent = currentUser.name.split(' ').map(n => n[0]).join('');
            
            const roleClass = currentUser.role === 'admin' ? 'admin-badge' : 'contractor-badge';
            document.getElementById('current-user-role').className = 'user-role-badge ' + roleClass;
        }

        function updateNavigation() {
            if (currentUser.role === 'admin') {
                document.getElementById('contractor-nav').classList.add('hidden');
                document.getElementById('admin-nav').classList.remove('hidden');
                document.getElementById('app-title').textContent = 'CCTV Admin Portal';
                navigateTo('admin-dashboard');
            } else {
                document.getElementById('admin-nav').classList.add('hidden');
                document.getElementById('contractor-nav').classList.remove('hidden');
                document.getElementById('app-title').textContent = 'CCTV Contractor Portal';
                navigateTo('dashboard');
            }
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            const activeCameras = cameras.filter(c => !c.retired);
            
            if (currentUser.role === 'contractor') {
                const assigned = activeCameras.filter(c => c.assignedTo === currentUser.name).length;
                const checkedToday = activeCameras.filter(c => c.lastChecked === today && c.assignedTo === currentUser.name).length;
                const overdue = activeCameras.filter(c => c.status === 'overdue' && c.assignedTo === currentUser.name).length;
                const myTasks = tasks.filter(t => t.assignedTo === currentUser.name || t.createdBy === currentUser.name);
                
                document.getElementById('stat-assigned').textContent = assigned;
                document.getElementById('stat-checked').textContent = checkedToday;
                document.getElementById('stat-overdue').textContent = overdue;
                document.getElementById('stat-tasks').textContent = myTasks.length;
                
                document.getElementById('nav-assigned-count').textContent = assigned;
                document.getElementById('nav-overdue-count').textContent = overdue;
                document.getElementById('nav-my-tasks-count').textContent = myTasks.length;
                
                // Update my tasks stats
                const myTasksPage = document.getElementById('my-tasks-total');
                if (myTasksPage) {
                    const pending = myTasks.filter(t => t.status === 'pending' || t.status === 'in-progress').length;
                    const completed = myTasks.filter(t => t.status === 'completed').length;
                    const taskOverdue = myTasks.filter(t => t.dueDate < today && t.status !== 'completed').length;
                    
                    myTasksPage.textContent = myTasks.length;
                    document.getElementById('my-tasks-pending').textContent = pending;
                    document.getElementById('my-tasks-completed').textContent = completed;
                    document.getElementById('my-tasks-overdue').textContent = taskOverdue;
                }
            } else {
                const totalCameras = cameras.length;
                const activeCount = activeCameras.length;
                const overdue = activeCameras.filter(c => c.status === 'overdue').length;
                
                document.getElementById('admin-stat-cameras').textContent = totalCameras;
                document.getElementById('admin-stat-active').textContent = activeCount;
                document.getElementById('admin-stat-overdue').textContent = overdue;
                document.getElementById('admin-stat-tasks').textContent = tasks.length;
                
                document.getElementById('nav-total-cameras').textContent = totalCameras;
                document.getElementById('nav-total-users').textContent = users.length;
                document.getElementById('nav-all-tasks-count').textContent = tasks.length;
                
                // Update all tasks stats
                const allTasksPage = document.getElementById('all-tasks-total');
                if (allTasksPage) {
                    const pending = tasks.filter(t => t.status === 'pending' || t.status === 'in-progress').length;
                    const completed = tasks.filter(t => t.status === 'completed').length;
                    const taskOverdue = tasks.filter(t => t.dueDate < today && t.status !== 'completed').length;
                    
                    allTasksPage.textContent = tasks.length;
                    document.getElementById('all-tasks-pending').textContent = pending;
                    document.getElementById('all-tasks-completed').textContent = completed;
                    document.getElementById('all-tasks-overdue').textContent = taskOverdue;
                }
            }
        }

        function navigateTo(page) {
            document.querySelectorAll('[id$="-page"]').forEach(p => p.classList.add('hidden'));
            document.getElementById(page + '-page').classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            currentPage = page;
            renderContent();
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('open');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }
        }

        function renderContent() {
            switch(currentPage) {
                case 'dashboard':
                    renderDashboard();
                    break;
                case 'admin-dashboard':
                    renderAdminDashboard();
                    break;
                case 'my-cameras':
                    renderMyCameras();
                    break;
                case 'overdue':
                    renderOverdue();
                    break;
                case 'my-tasks':
                    renderMyTasks();
                    break;
                case 'camera-management':
                    renderCameraManagement();
                    break;
                case 'all-tasks':
                    renderAllTasks();
                    break;
                case 'users':
                    renderUsers();
                    break;
            }
        }

        function renderDashboard() {
            const container = document.getElementById('dashboard-grid');
            const myCameras = cameras.filter(c => c.assignedTo === currentUser.name && !c.retired);
            const myTasks = tasks.filter(t => t.assignedTo === currentUser.name || t.createdBy === currentUser.name);
            
            const items = [...myCameras.map(c => ({...c, type: 'camera'})), ...myTasks.slice(0, 2).map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderAdminDashboard() {
            const container = document.getElementById('admin-dashboard-grid');
            const recentCameras = cameras.slice(0, 3);
            const recentTasks = tasks.slice(0, 3);
            
            const items = [...recentCameras.map(c => ({...c, type: 'camera'})), ...recentTasks.map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderMyCameras() {
            const container = document.getElementById('my-cameras-grid');
            const myCameras = cameras.filter(c => c.assignedTo === currentUser.name && !c.retired);
            container.innerHTML = myCameras.map(c => createItemCard({...c, type: 'camera'})).join('');
        }

        function renderOverdue() {
            const container = document.getElementById('overdue-grid');
            const today = new Date().toISOString().split('T')[0];
            const overdueCameras = cameras.filter(c => c.status === 'overdue' && c.assignedTo === currentUser.name);
            const overdueTasks = tasks.filter(t => (t.assignedTo === currentUser.name || currentUser.role === 'admin') && t.dueDate < today && t.status !== 'completed');
            
            const items = [...overdueCameras.map(c => ({...c, type: 'camera'})), ...overdueTasks.map(t => ({...t, type: 'task'}))];
            container.innerHTML = items.map(item => createItemCard(item)).join('');
        }

        function renderMyTasks() {
            const container = document.getElementById('my-tasks-grid');
            const myTasks = tasks.filter(t => t.assignedTo === currentUser.name || t.createdBy === currentUser.name);
            container.innerHTML = myTasks.map(t => createItemCard({...t, type: 'task'})).join('');
        }

        function renderCameraManagement() {
            const container = document.getElementById('camera-management-grid');
            container.innerHTML = cameras.map(c => createItemCard({...c, type: 'camera'})).join('');
        }

        function renderAllTasks() {
            const container = document.getElementById('all-tasks-grid');
            container.innerHTML = tasks.map(t => createItemCard({...t, type: 'task'})).join('');
        }

        function renderUsers() {
            const container = document.getElementById('users-grid');
            container.innerHTML = users.map(u => createItemCard({...u, type: 'user'})).join('');
        }

        function createItemCard(item) {
            if (item.type === 'camera') {
                return createCameraCard(item);
            } else if (item.type === 'task') {
                return createTaskCard(item);
            } else if (item.type === 'user') {
                return createUserCard(item);
            }
        }

        function createCameraCard(camera) {
            const today = new Date().toISOString().split('T')[0];
            const isCheckedToday = camera.lastChecked === today;
            const canCheck = !camera.retired && ((currentUser.role === 'admin') || (currentUser.role === 'contractor' && camera.assignedTo === currentUser.name && !isCheckedToday));
            
            return '<div class="item-card">' +
                '<div class="item-header">' +
                '<div class="item-info">' +
                '<div class="item-title">' +
                '<span style="font-size: 18px;">📷</span>' +
                '<h3>' + camera.name + '</h3>' +
                '</div>' +
                '<div class="item-location">' +
                '<span style="font-size: 12px; margin-right: 4px;">📍</span>' +
                '<span>' + camera.location + '</span>' +
                '</div>' +
                '<div class="item-badges">' +
                getStatusBadge(camera.status) +
                getPriorityBadge(camera.priority) +
                '</div>' +
                '</div>' +
                '<div style="color: ' + (camera.status === 'overdue' ? '#dc2626' : '#059669') + '; font-size: 20px;">' +
                (camera.status === 'overdue' ? '⚠️' : '✅') +
                '</div>' +
                '</div>' +
                '<div class="item-details">' +
                '<div class="detail-row">' +
                '<span class="detail-label">Assigned To:</span>' +
                '<span class="detail-value">' + (camera.assignedTo || 'Unassigned') + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Last Checked:</span>' +
                '<span class="detail-value">' + (camera.lastChecked ? formatDate(camera.lastChecked) : 'Never') + '</span>' +
                '</div>' +
                '</div>' +
                (canCheck ? 
                    '<button class="action-button-full enabled" onclick="performCheck(\'' + camera.id + '\')">Perform Check</button>' :
                    '<button class="action-button-full disabled" disabled>' + (isCheckedToday ? 'Checked Today' : 'Not Available') + '</button>'
                ) +
                '</div>';
        }

        function createTaskCard(task) {
            const today = new Date().toISOString().split('T')[0];
            const isOverdue = task.dueDate && task.dueDate < today && task.status !== 'completed';
            const canComplete = task.assignedTo === currentUser.name && task.status !== 'completed';
            const canEdit = currentUser.role === 'admin' || task.createdBy === currentUser.name || task.assignedTo === currentUser.name;
            
            return '<div class="item-card">' +
                '<div class="item-header">' +
                '<div class="item-info">' +
                '<div class="item-title">' +
                '<span style="font-size: 18px;">📋</span>' +
                '<h3>' + task.title + '</h3>' +
                '</div>' +
                '<div class="item-location">' +
                '<span style="font-size: 12px; margin-right: 4px;">🏷️</span>' +
                '<span>' + task.type.charAt(0).toUpperCase() + task.type.slice(1) + '</span>' +
                '</div>' +
                '<div class="item-badges">' +
                getTaskStatusBadge(task.status, isOverdue) +
                getPriorityBadge(task.priority) +
                '</div>' +
                '</div>' +
                '<div style="color: ' + getTaskStatusColor(task.status, isOverdue) + '; font-size: 20px;">' +
                getTaskStatusIcon(task.status, isOverdue) +
                '</div>' +
                '</div>' +
                '<div class="item-details">' +
                (task.description ? 
                    '<div style="margin-bottom: 12px;">' +
                    '<span class="detail-label">Description:</span>' +
                    '<div class="previous-notes">' + task.description + '</div>' +
                    '</div>' : ''
                ) +
                '<div class="detail-row">' +
                '<span class="detail-label">Assigned To:</span>' +
                '<span class="detail-value">' + (task.assignedTo || 'Unassigned') + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Due Date:</span>' +
                '<span class="detail-value ' + (isOverdue ? 'overdue' : '') + '">' +
                (task.dueDate ? formatDate(task.dueDate) : 'No due date') +
                '</span>' +
                '</div>' +
                '</div>' +
                '<div style="display: flex; gap: 8px;">' +
                (canComplete ? 
                    '<button class="action-button-full enabled" style="flex: 1;" onclick="completeTask(\'' + task.id + '\')">' + 
                    (task.status === 'in-progress' ? 'Complete Task' : 'Start Task') + '</button>' :
                    '<button class="action-button-full disabled" style="flex: 1;" disabled>' + 
                    (task.status === 'completed' ? 'Task Completed' : 'Not Available') + '</button>'
                ) +
                (canEdit ? 
                    '<button class="admin-btn edit" onclick="editTask(\'' + task.id + '\')" style="flex: 0 0 auto; padding: 12px;">✏️</button>' : ''
                ) +
                '</div>' +
                '</div>';
        }

        function createUserCard(user) {
            return '<div class="item-card">' +
                '<div class="item-header">' +
                '<div class="item-info">' +
                '<div class="item-title">' +
                '<span style="font-size: 18px;">👤</span>' +
                '<h3>' + user.name + '</h3>' +
                '</div>' +
                '<div class="item-location">' +
                '<span style="font-size: 12px; margin-right: 4px;">📧</span>' +
                '<span>' + user.email + '</span>' +
                '</div>' +
                '<div class="item-badges">' +
                '<span class="badge badge-' + user.role + '">' + user.role.toUpperCase() + '</span>' +
                '<span class="badge badge-' + user.status + '">' + user.status.toUpperCase() + '</span>' +
                '</div>' +
                '</div>' +
                '<div style="color: #059669; font-size: 20px;">👤</div>' +
                '</div>' +
                '<div class="item-details">' +
                '<div class="detail-row">' +
                '<span class="detail-label">Role:</span>' +
                '<span class="detail-value">' + user.role + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Company:</span>' +
                '<span class="detail-value">' + user.company + '</span>' +
                '</div>' +
                '<div class="detail-row">' +
                '<span class="detail-label">Status:</span>' +
                '<span class="detail-value">' + user.status + '</span>' +
                '</div>' +
                '</div>' +
                (currentUser.role === 'admin' ? 
                    '<button class="action-button-full enabled" onclick="editUser(\'' + user.id + '\')">Edit User</button>' :
                    '<button class="action-button-full disabled" disabled>View Only</button>'
                ) +
                '</div>';
        }

        function getStatusBadge(status) {
            switch(status) {
                case 'overdue': return '<span class="badge badge-overdue">OVERDUE</span>';
                case 'recent': return '<span class="badge badge-recent">RECENT</span>';
                case 'due-soon': return '<span class="badge badge-due-soon">DUE SOON</span>';
                default: return '<span class="badge badge-pending">PENDING</span>';
            }
        }

        function getTaskStatusBadge(status, isOverdue) {
            if (isOverdue && status !== 'completed') {
                return '<span class="badge badge-overdue">OVERDUE</span>';
            }
            switch(status) {
                case 'completed': return '<span class="badge badge-completed">COMPLETED</span>';
                case 'in-progress': return '<span class="badge badge-in-progress">IN PROGRESS</span>';
                case 'pending': return '<span class="badge badge-pending">PENDING</span>';
                default: return '<span class="badge badge-pending">PENDING</span>';
            }
        }

        function getPriorityBadge(priority) {
            return '<span class="badge badge-priority badge-' + priority + '">' + priority.toUpperCase() + '</span>';
        }

        function getTaskStatusColor(status, isOverdue) {
            if (isOverdue && status !== 'completed') return '#dc2626';
            switch(status) {
                case 'completed': return '#059669';
                case 'in-progress': return '#f59e0b';
                default: return '#64748b';
            }
        }

        function getTaskStatusIcon(status, isOverdue) {
            if (isOverdue && status !== 'completed') return '⚠️';
            switch(status) {
                case 'completed': return '✅';
                case 'in-progress': return '🔄';
                default: return '📋';
            }
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-GB');
        }

        // Task management functions
        function addNewTask() {
            selectedTask = null;
            document.getElementById('task-modal-title').textContent = 'Create New Task';
            document.getElementById('task-form').reset();
            document.getElementById('task-priority').value = 'medium';
            
            // Set default due date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('task-due-date').value = tomorrow.toISOString().split('T')[0];
            
            document.getElementById('task-modal').classList.remove('hidden');
        }

        function editTask(taskId) {
            selectedTask = tasks.find(t => t.id === taskId);
            if (!selectedTask) return;
            
            document.getElementById('task-modal-title').textContent = 'Edit Task';
            document.getElementById('task-title').value = selectedTask.title;
            document.getElementById('task-type').value = selectedTask.type;
            document.getElementById('task-description').value = selectedTask.description;
            document.getElementById('task-assigned').value = selectedTask.assignedTo || '';
            document.getElementById('task-priority').value = selectedTask.priority;
            document.getElementById('task-due-date').value = selectedTask.dueDate || '';
            document.getElementById('task-camera').value = selectedTask.relatedCamera || '';
            document.getElementById('task-id').value = selectedTask.id;
            
            document.getElementById('task-modal').classList.remove('hidden');
        }

        function saveTask() {
            const form = document.getElementById('task-form');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const taskData = {
                title: document.getElementById('task-title').value,
                type: document.getElementById('task-type').value,
                description: document.getElementById('task-description').value,
                assignedTo: document.getElementById('task-assigned').value || null,
                priority: document.getElementById('task-priority').value,
                dueDate: document.getElementById('task-due-date').value || null,
                relatedCamera: document.getElementById('task-camera').value || null
            };
            
            if (selectedTask) {
                // Update existing task
                Object.assign(selectedTask, taskData);
            } else {
                // Add new task
                const newTask = {
                    id: 'TASK' + String(tasks.length + 1).padStart(3, '0'),
                    ...taskData,
                    createdBy: currentUser.name,
                    status: 'pending',
                    createdDate: new Date().toISOString().split('T')[0]
                };
                tasks.push(newTask);
            }
            
            closeModal('task-modal');
            updateStats();
            renderContent();
            
            alert('Task ' + (selectedTask ? 'updated' : 'created') + ' successfully!');
        }

        function completeTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (!task) return;
            
            if (task.status === 'pending') {
                task.status = 'in-progress';
                alert('Task "' + task.title + '" marked as in progress.');
            } else if (task.status === 'in-progress') {
                task.status = 'completed';
                alert('Task "' + task.title + '" completed successfully!');
            }
            
            updateStats();
            renderContent();
        }

        function performCheck(cameraId) {
            const camera = cameras.find(c => c.id === cameraId);
            if (!camera) return;
            
            const today = new Date().toISOString().split('T')[0];
            camera.lastChecked = today;
            camera.status = 'recent';
            
            updateStats();
            renderContent();
            
            alert('Check completed for ' + camera.name);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            selectedTask = null;
        }

        function addNewCamera() {
            alert('Camera management feature coming soon!');
        }

        function addNewUser() {
            alert('User management feature coming soon!');
        }

        function editUser(userId) {
            alert('User editing feature coming soon!');
        }

        // Make functions globally available
        window.loginAs = loginAs;
        window.logout = logout;
        window.navigateTo = navigateTo;
        window.toggleSidebar = toggleSidebar;
        window.addNewTask = addNewTask;
        window.editTask = editTask;
        window.saveTask = saveTask;
        window.completeTask = completeTask;
        window.performCheck = performCheck;
        window.closeModal = closeModal;
        window.addNewCamera = addNewCamera;
        window.addNewUser = addNewUser;
        window.editUser = editUser;
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCTV Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8fafc;
            min-height: 100vh;
        }

        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 12px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .login-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-logo {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #7c3aed, #3b82f6);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 32px;
        }

        .login-title {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .login-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .demo-accounts {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid #e5e7eb;
        }

        .demo-title {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
            text-align: center;
        }

        .demo-account {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .demo-account:hover {
            background: #e2e8f0;
            border-color: #2563eb;
        }

        .demo-account-info {
            font-size: 14px;
        }

        .demo-account-role {
            font-weight: 600;
            color: #1e293b;
        }

        .demo-account-email {
            color: #64748b;
            font-size: 12px;
        }

        .demo-account-badge {
            font-size: 10px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 6px;
        }

        .admin-badge {
            background: #fee2e2;
            color: #991b1b;
        }

        .contractor-badge {
            background: #dbeafe;
            color: #1e40af;
        }

        .app-container {
            display: flex;
            min-height: 100vh;
        }

        .top-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            background: white;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 50;
        }

        .header-left {
            display: flex;
            align-items: center;
        }

        .menu-toggle {
            background: none;
            border: none;
            padding: 8px;
            margin-right: 12px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 18px;
        }

        .menu-toggle:hover {
            background: #f1f5f9;
        }

        .logo {
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #7c3aed, #3b82f6);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 16px;
        }

        .header-title h1 {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
        }

        .header-right {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #e2e8f0;
        }

        .user-info:hover {
            background: #f1f5f9;
        }

        .user-avatar {
            width: 28px;
            height: 28px;
            background: #94a3b8;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .user-details {
            font-size: 14px;
            font-weight: 500;
            color: #1e293b;
        }

        .user-role-badge {
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 8px;
        }

        .logout-btn {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            padding: 6px;
            border-radius: 4px;
        }

        .logout-btn:hover {
            background: #fee2e2;
            color: #dc2626;
        }

        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid #e2e8f0;
            margin-top: 56px;
            position: fixed;
            height: calc(100vh - 56px);
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 40;
        }

        .sidebar.collapsed {
            transform: translateX(-100%);
        }

        .sidebar-content {
            padding: 16px 0;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0 16px 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 12px 16px;
            border: none;
            background: none;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: #475569;
        }

        .nav-item:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .nav-item.active {
            background: #eff6ff;
            color: #2563eb;
            border-right: 3px solid #2563eb;
        }

        .nav-icon {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            font-size: 16px;
            text-align: center;
        }

        .nav-badge {
            margin-left: auto;
            background: #e2e8f0;
            color: #64748b;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
        }

        .nav-badge.urgent {
            background: #fee2e2;
            color: #dc2626;
        }

        .nav-badge.success {
            background: #dcfce7;
            color: #166534;
        }

        .main-content {
            flex: 1;
            margin-left: 280px;
            margin-top: 56px;
            transition: margin-left 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .content-header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .content-title {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .content-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        .content-actions {
            display: flex;
            gap: 12px;
        }

        .action-button {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-button:hover {
            background: #f9fafb;
        }

        .action-button.primary {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .action-button.primary:hover {
            background: #1d4ed8;
        }

        .content-body {
            padding: 24px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -8px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .stat-blue .stat-number { color: #2563eb; }
        .stat-green .stat-number { color: #059669; }
        .stat-red .stat-number { color: #dc2626; }
        .stat-orange .stat-number { color: #ea580c; }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 20px;
        }

        .item-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s;
        }

        .item-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px -8px rgba(0, 0, 0, 0.1);
        }

        .item-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .item-info {
            flex: 1;
        }

        .item-title {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .item-title h3 {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-left: 8px;
        }

        .item-location {
            display: flex;
            align-items: center;
            font-size: 13px;
            color: #64748b;
            margin-bottom: 12px;
        }

        .item-badges {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-checked {
            background: #dcfce7;
            color: #166534;
        }

        .badge-overdue {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-due-soon {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-recent {
            background: #dcfce7;
            color: #166534;
        }

        .badge-pending {
            background: #e0f2fe;
            color: #0277bd;
        }

        .badge-in-progress {
            background: #fff3e0;
            color: #f57c00;
        }

        .badge-completed {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .badge-retired {
            background: #f3f4f6;
            color: #6b7280;
        }

        .badge-priority {
            border: 1px solid;
        }

        .badge-high {
            background: #fee2e2;
            color: #b91c1c;
            border-color: #fecaca;
        }

        .badge-medium {
            background: #fed7aa;
            color: #c2410c;
            border-color: #fdba74;
        }

        .badge-low {
            background: #f3f4f6;
            color: #374151;
            border-color: #d1d5db;
        }

        .item-details {
            font-size: 13px;
            margin-bottom: 16px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .detail-label {
            color: #64748b;
        }

        .detail-value {
            color: #1e293b;
            font-weight: 500;
        }

        .detail-value.overdue {
            color: #dc2626;
        }

        .previous-notes {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            color: #64748b;
            margin-top: 8px;
            border-left: 3px solid #e2e8f0;
        }

        .action-button-full {
            width: 100%;
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 8px;
        }

        .action-button-full.enabled {
            background: #2563eb;
            color: white;
        }

        .action-button-full.enabled:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }

        .action-button-full.disabled {
            background: #f1f5f9;
            color: #94a3b8;
            cursor: not-allowed;
        }

        .admin-actions {
            display: flex;
            gap: 8px;
        }

        .admin-btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .admin-btn:hover {
            background: #f9fafb;
        }

        .admin-btn.edit {
            border-color: #2563eb;
            color: #2563eb;
        }

        .admin-btn.retire {
            border-color: #dc2626;
            color: #dc2626;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .content-header {
                padding: 16px;
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .content-body {
                padding: 16px;
            }

            .items-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="login-page">
        <div class="login-container">
            <div class="login-card">
                <div class="login-header">
                    <div class="login-logo">📷</div>
                    <h1 class="login-title">CCTV Management</h1>
                    <p class="login-subtitle">Sign in to your account</p>
                </div>

                <div class="demo-accounts">
                    <div class="demo-title">Demo Accounts - Click to Login</div>
                    <div class="demo-account" onclick="loginAs('admin')">
                        <div class="demo-account-info">
                            <div class="demo-account-role">Site Manager</div>
                            <div class="demo-account-email">admin@site.com</div>
                        </div>
                        <span class="demo-account-badge admin-badge">ADMIN</span>
                    </div>
                    <div class="demo-account" onclick="loginAs('contractor')">
                        <div class="demo-account-info">
                            <div class="demo-account-role">Field Contractor</div>
                            <div class="demo-account-email">john@securetech.com</div>
                        </div>
                        <span class="demo-account-badge contractor-badge">CONTRACTOR</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="main-app" class="hidden">
        <!-- Top Header -->
        <div class="top-header">
            <div class="header-left">
                <button class="menu-toggle" onclick="toggleSidebar()">☰</button>
                <div class="logo">📷</div>
                <div class="header-title">
                    <h1 id="app-title">CCTV Management</h1>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-details" id="current-user-name">John Smith</div>
                    <span class="user-role-badge contractor-badge" id="current-user-role">CONTRACTOR</span>
                    <div class="user-avatar" id="current-user-avatar">JS</div>
                    <button class="logout-btn" onclick="logout()" title="Sign Out">🚪</button>
                </div>
            </div>
        </div>

        <div class="app-container">
            <!-- Sidebar -->
            <div class="sidebar" id="sidebar">
                <div class="sidebar-content">
                    <!-- Contractor Navigation -->
                    <div id="contractor-nav">
                        <div class="nav-section">
                            <div class="nav-section-title">Overview</div>
                            <button class="nav-item active" onclick="navigateTo('dashboard')">
                                <span class="nav-icon">📊</span>
                                Dashboard
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Cameras</div>
                            <button class="nav-item" onclick="navigateTo('my-cameras')">
                                <span class="nav-icon">📷</span>
                                My Cameras
                                <span class="nav-badge" id="nav-assigned-count">3</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('overdue')">
                                <span class="nav-icon">⚠️</span>
                                Overdue Checks
                                <span class="nav-badge urgent" id="nav-overdue-count">2</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('completed')">
                                <span class="nav-icon">✅</span>
                                Today's Checks
                                <span class="nav-badge success" id="nav-completed-count">1</span>
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Tasks</div>
                            <button class="nav-item" onclick="navigateTo('my-tasks')">
                                <span class="nav-icon">📋</span>
                                My Tasks
                                <span class="nav-badge" id="nav-my-tasks-count">4</span>
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Reports</div>
                            <button class="nav-item" onclick="navigateTo('history')">
                                <span class="nav-icon">📜</span>
                                Check History
                            </button>
                        </div>
                    </div>

                    <!-- Admin Navigation -->
                    <div id="admin-nav" class="hidden">
                        <div class="nav-section">
                            <div class="nav-section-title">Overview</div>
                            <button class="nav-item active" onclick="navigateTo('admin-dashboard')">
                                <span class="nav-icon">📊</span>
                                Dashboard
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Cameras</div>
                            <button class="nav-item" onclick="navigateTo('camera-management')">
                                <span class="nav-icon">📷</span>
                                Camera Management
                                <span class="nav-badge" id="nav-total-cameras">8</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('all-cameras')">
                                <span class="nav-icon">🗂️</span>
                                All Cameras List
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Tasks</div>
                            <button class="nav-item" onclick="navigateTo('all-tasks')">
                                <span class="nav-icon">📋</span>
                                All Tasks
                                <span class="nav-badge" id="nav-all-tasks-count">12</span>
                            </button>
                            <button class="nav-item" onclick="navigateTo('task-overview')">
                                <span class="nav-icon">📊</span>
                                Task Overview
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Users</div>
                            <button class="nav-item" onclick="navigateTo('users')">
                                <span class="nav-icon">👥</span>
                                Users
                                <span class="nav-badge" id="nav-total-users">5</span>
                            </button>
                        </div>

                        <div class="nav-section">
                            <div class="nav-section-title">Reports</div>
                            <button class="nav-item" onclick="navigateTo('all-checks')">
                                <span class="nav-icon">📋</span>
                                All Check Reports
                            </button>
                            <button class="nav-item" onclick="navigateTo('issues')">
                                <span class="nav-icon">⚠️</span>
                                Issue Tracking
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content" id="main-content">
                
                <!-- Contractor Dashboard -->
                <div id="dashboard-page">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Dashboard</h1>
                            <p class="content-subtitle">Overview of your assignments</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="stat-assigned">3</div>
                                <div class="stat-label">Assigned Cameras</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="stat-checked">1</div>
                                <div class="stat-label">Checked Today</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="stat-overdue">2</div>
                                <div class="stat-label">Overdue Checks</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="stat-tasks">4</div>
                                <div class="stat-label">Active Tasks</div>
                            </div>
                        </div>
                        
                        <div class="items-grid" id="dashboard-grid"></div>
                    </div>
                </div>

                <!-- Admin Dashboard -->
                <div id="admin-dashboard-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Admin Dashboard</h1>
                            <p class="content-subtitle">System overview and management</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="admin-stat-cameras">8</div>
                                <div class="stat-label">Total Cameras</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="admin-stat-active">6</div>
                                <div class="stat-label">Active Cameras</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="admin-stat-overdue">3</div>
                                <div class="stat-label">Overdue Items</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="admin-stat-tasks">12</div>
                                <div class="stat-label">Total Tasks</div>
                            </div>
                        </div>
                        
                        <div class="items-grid" id="admin-dashboard-grid"></div>
                    </div>
                </div>

                <!-- My Cameras Page -->
                <div id="my-cameras-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">My Cameras</h1>
                            <p class="content-subtitle">Cameras assigned to you</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="items-grid" id="my-cameras-grid"></div>
                    </div>
                </div>

                <!-- Overdue Page -->
                <div id="overdue-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Overdue Items</h1>
                            <p class="content-subtitle">Items that need immediate attention</p>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="items-grid" id="overdue-grid"></div>
                    </div>
                </div>

                <!-- My Tasks Page -->
                <div id="my-tasks-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">My Tasks</h1>
                            <p class="content-subtitle">Tasks assigned to you</p>
                        </div>
                        <div class="content-actions">
                            <button class="action-button primary" onclick="addNewTask()">
                                <span>➕</span>
                                Create Task
                            </button>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="stats-grid">
                            <div class="stat-card stat-blue">
                                <div class="stat-number" id="my-tasks-total">4</div>
                                <div class="stat-label">Total Tasks</div>
                            </div>
                            <div class="stat-card stat-orange">
                                <div class="stat-number" id="my-tasks-pending">2</div>
                                <div class="stat-label">Pending</div>
                            </div>
                            <div class="stat-card stat-green">
                                <div class="stat-number" id="my-tasks-completed">1</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-card stat-red">
                                <div class="stat-number" id="my-tasks-overdue">1</div>
                                <div class="stat-label">Overdue</div>
                            </div>
                        </div>
                        <div class="items-grid" id="my-tasks-grid"></div>
                    </div>
                </div>

                <!-- Camera Management Page -->
                <div id="camera-management-page" class="hidden">
                    <div class="content-header">
                        <div>
                            <h1 class="content-title">Camera Management</h1>
                            <p class="content-subtitle">Manage all camera assets</p>
                        </div>
                        <div class="content-actions">
                            <button class="action-button primary" onclick="addNewCamera()">
                                <span>➕</span>
                                Add Camera
                            </button>
                        </div>
                    </div>
                    <div class="content-body">
                        <div class="items-grid" id="camera-management-grid"></div>
                    </div>
                </div>

                <!-- All Tasks Page -->
